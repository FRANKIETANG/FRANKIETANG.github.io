<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 补基础：React-Redux-ES6-webpack-babel · 付林恒的博客</title><meta name="description" content="补基础：React-Redux-ES6-webpack-babel - Frankie Tang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="付林恒的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/frankietang" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">补基础：React-Redux-ES6-webpack-babel</h1><div class="post-info">Nov 5, 2017</div><div class="post-content"><h1 id="补基础：React-Redux-ES6-webpack-babel"><a href="#补基础：React-Redux-ES6-webpack-babel" class="headerlink" title="补基础：React-Redux-ES6-webpack-babel"></a>补基础：React-Redux-ES6-webpack-babel</h1><p><a href="https://www.docschina.org/" target="_blank" rel="external">印记中文</a></p>
<p>先看一遍中文文档，第二遍中英文对着看，第三遍才看英文文档</p>
<h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><p><a href="https://facebook.github.io/react/" target="_blank" rel="external">React 官方文档</a></p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
</pre></td><td class="code"><pre><span class="line">/**</span>
<span class="line"> * JSX : xml <span class="keyword">in</span> JavaScript</span>
<span class="line"> * <span class="number">1</span>、<span class="keyword">tag</span>Name</span>
<span class="line"> * <span class="number">2</span>、attributes(props)</span>
<span class="line"> * <span class="number">3</span>、children</span>
<span class="line"> */</span>
<span class="line">/**</span>
<span class="line"> * 组件化: </span>
<span class="line"> * <span class="number">1</span>、函数式组件props =&gt; JSX ; </span>
<span class="line"> * <span class="number">2</span>、类组件:class A extends Component;</span>
<span class="line"> */ </span>
<span class="line">/**</span>
<span class="line"> * 数据源 : <span class="keyword">state</span>  + props</span>
<span class="line"> * 更新数据: <span class="built_in">set</span>State</span>
<span class="line"> * 方案: 当数据越来越复杂的时候，我们需要一个数据解决方案 ==&gt; redux</span>
<span class="line"> * 发起数据变更(click etc.) ==&gt; action</span>
<span class="line"> * 生成新的数据结构(<span class="keyword">state</span>[store])  ==&gt; redux的reducer生成react的<span class="keyword">state</span></span>
<span class="line"> * 渲染(render) ==&gt; react来做</span>
<span class="line"> */</span>
</pre></td></tr></table></figure>
<h3 id="DOM-对比"><a href="#DOM-对比" class="headerlink" title="DOM 对比"></a>DOM 对比</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 传统方式</span></span>
<span class="line">&lt;<span class="keyword">div</span> data-id=<span class="string">'1'</span>&gt;</span>
<span class="line">	hello world</span>
<span class="line">&lt;/<span class="keyword">div</span>&gt;</span>
<span class="line"></span>
<span class="line"><span class="comment">// vue </span></span>
<span class="line">&lt;<span class="keyword">div</span> data-id=&#123;&#123;id&#125;&#125;&gt;</span>
<span class="line">	&#123;&#123;name&#125;&#125;</span>
<span class="line">&lt;/<span class="keyword">div</span>&gt;</span>
<span class="line">&#123;</span>
<span class="line">  	data: ()=&gt; &#123;</span>
<span class="line">      	<span class="keyword">return</span> &#123;</span>
<span class="line">          	name: <span class="string">'hello world'</span>,</span>
<span class="line">          	id: <span class="number">1</span></span>
<span class="line">      	&#125;</span>
<span class="line">  	&#125;</span>
<span class="line">&#125;</span>
<span class="line"><span class="comment">// 注意 vue 是一个 MVVM 框架</span></span>
<span class="line"><span class="comment">// 特点就是数据和模板分离</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 实际上 react 也可以认为是一个 MVVM 框架</span></span>
<span class="line">var JSX = &lt;<span class="keyword">div</span> data-id=<span class="string">'1'</span>&gt;</span>
<span class="line">	hello world</span>
<span class="line">&lt;/<span class="keyword">div</span>&gt;;</span>
<span class="line">render(JSX,document.getElementById(<span class="string">'root'</span>));</span>
<span class="line"><span class="comment">// 数据和模板绑定在一起</span></span>
<span class="line"></span>
<span class="line">Virtual dom</span>
<span class="line"></span>
<span class="line">&lt;<span class="keyword">div</span> width=<span class="string">'100px'</span>&gt;a&lt;/<span class="keyword">div</span>&gt;</span>
<span class="line">==&gt;</span>
<span class="line">tagname: <span class="keyword">div</span></span>
<span class="line">attributes:&#123;width: <span class="string">'100px'</span>&#125;</span>
<span class="line">children: a</span>
<span class="line"></span>
<span class="line">==&gt; IOS / Android</span>
<span class="line">tagname: UIButton</span>
<span class="line">attributes:&#123;display: flex&#125;</span>
<span class="line">children: ...</span>
</pre></td></tr></table></figure>
<h3 id="用-react-问候世界"><a href="#用-react-问候世界" class="headerlink" title="用 react 问候世界"></a>用 react 问候世界</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> react, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span> <span class="comment">// 基础库</span></span>
<span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>  <span class="comment">// 平台库 这是 web 库</span></span>
<span class="line"><span class="comment">// 为什么要引两个库呢？</span></span>
<span class="line"><span class="comment">// 为了跨平台</span></span>
<span class="line"><span class="comment">// 比如在 ios/android 用上 react-native</span></span>
<span class="line"><span class="comment">// import from 'react-natiev'</span></span>
<span class="line">render(</span>
<span class="line">	&lt;h1&gt;Hello, world&lt;<span class="regexp">/h1&gt;              /</span><span class="regexp">/ 要塞的代码</span></span>
<span class="line"><span class="regexp">	document.getElementById('root')    /</span><span class="regexp">/ 容器</span></span>
<span class="line"><span class="regexp">)</span></span>
<span class="line"><span class="regexp"></span></span>
<span class="line"><span class="regexp">/</span><span class="regexp">/ 接下来看看用 webpack 编译后的代码</span></span>
<span class="line"><span class="regexp">_react2.default.createElement(</span></span>
<span class="line"><span class="regexp">  'h1',</span></span>
<span class="line"><span class="regexp">  null,</span></span>
<span class="line"><span class="regexp">  'Hello, world!'</span></span>
<span class="line"><span class="regexp"></span></span>
<span class="line"><span class="regexp">/</span>*</span>
<span class="line"> 也就是说 react 会把 JSX 分成三个部分</span>
<span class="line"> * tagname</span>
<span class="line"> * attributes</span>
<span class="line"> * children</span>
<span class="line">*<span class="regexp">/</span></span>
</pre></td></tr></table></figure>
<h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
</pre></td><td class="code"><pre><span class="line">// 这种模板语法就叫做 JSX</span>
<span class="line"><span class="keyword">import</span> React, &#123; Component &#125; from <span class="string">'react'</span></span>
<span class="line"><span class="keyword">import</span> &#123; render &#125; from <span class="string">'react-dom'</span></span>
<span class="line">const RootDom = document.getElementById(<span class="string">'root'</span>)</span>
<span class="line"><span class="keyword">let</span> JSX = &lt;div name=<span class="string">"frankie"</span>&gt;</span>
<span class="line">	Hello world&lt;span&gt;你好&lt;/span&gt;</span>
<span class="line">&lt;/div&gt;</span>
<span class="line">render(JSX, RootDom)</span>
<span class="line"></span>
<span class="line">// 以下是编译出来的结果</span>
<span class="line">/*</span>
<span class="line">var JSX = _react2.<span class="keyword">default</span>.createElement(</span>
<span class="line">  <span class="string">'div'</span>,</span>
<span class="line">  &#123; name: <span class="string">'jirengu'</span> &#125;,</span>
<span class="line">  <span class="string">'Hello world'</span>,</span>
<span class="line">  _react2.<span class="keyword">default</span>.createElement(</span>
<span class="line">    <span class="string">'span'</span>,</span>
<span class="line">    null,</span>
<span class="line">    <span class="string">'\u4F60\u597D'</span></span>
<span class="line">  )</span>
<span class="line">);</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line">// 结构就相当于这个</span>
<span class="line">/*</span>
<span class="line">tagname: <span class="string">'div'</span></span>
<span class="line">attributes: &#123;</span>
<span class="line">  	name: <span class="string">'frankie'</span></span>
<span class="line">&#125;</span>
<span class="line">children: <span class="string">'hello world'</span>,&#123;</span>
<span class="line">  	tagname: <span class="string">'span'</span></span>
<span class="line">  	attributes: null</span>
<span class="line">  	children: <span class="string">'你好'</span></span>
<span class="line">&#125;</span>
<span class="line">*/</span>
</pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 值得注意的地方</span></span>
<span class="line"><span class="comment">// JSX 可以防止 XSS 漏洞</span></span>
<span class="line"><span class="comment">// 比如写在 JSX 里会直接输出，写在 HTML 会把 &amp;gt; 转成 &gt;</span></span>
<span class="line"></span>
<span class="line">render() &#123;</span>
<span class="line">  <span class="keyword">let</span> b = <span class="string">'First &amp;gt; Second'</span></span>
<span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;b&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span>
<span class="line">&#125; </span>
<span class="line"></span>
<span class="line"><span class="comment">// 如果要不转译该怎么办？</span></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">dangerouslySetInnerHTML函数</span></span>
<span class="line"><span class="comment">dangerouslySetInnerHTML是React提供的替换浏览器DOM中的innerHTML接口的一个函数。一般而言，使用JS代码设置HTML文档的内容是危险的，因为这样很容易把你的用户信息暴露给跨站脚本攻击.所以，你虽然可以直接在React中设置html的内容，但你要使用 dangerouslySetInnerHTML 并向该函数传递一个含有__html键的对象，用来提醒你自己这样做很危险。例如：</span></span>
<span class="line"><span class="comment">function createMarkup() &#123;</span></span>
<span class="line"><span class="comment">  return &#123;__html: 'First &amp;middot; Second'&#125;;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">function MyComponent() &#123;</span></span>
<span class="line"><span class="comment">  return &lt;div dangerouslySetInnerHTML=&#123;createMarkup()&#125; /&gt;;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 实际上，JSX 里面输入 false ，null ，undefined 都是不渲染的</span></span>
<span class="line"></span>
<span class="line">render() &#123;</span>
<span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;false&#125; &#123;null&#125; &#123;undefined&#125; &#123;0&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span>
<span class="line">&#125; </span>
<span class="line"></span>
<span class="line"><span class="comment">// 那如果有个空格在中间呢？</span></span>
<span class="line"></span>
<span class="line">render() &#123;</span>
<span class="line">  <span class="keyword">let</span> b = <span class="string">'First         Second'</span>  <span class="comment">// 这里这个空格会打印么？ 不会的</span></span>
<span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;b&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span>
<span class="line">&#125; </span>
<span class="line"></span>
<span class="line"><span class="comment">// 还有一些属性啊，比如 onChange onClick 都要用驼峰命名</span></span>
</pre></td></tr></table></figure>
<p><a href="https://zhuanlan.zhihu.com/p/22500730?refer=study-fe" target="_blank" rel="external">XSS是什么</a> <a href="https://zhuanlan.zhihu.com/p/22521378?refer=study-fe" target="_blank" rel="external">CSRF是什么</a></p>
<h3 id="JS-in-JSX（动态化）"><a href="#JS-in-JSX（动态化）" class="headerlink" title="JS-in-JSX（动态化）"></a>JS-in-JSX（动态化）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 记住要用大括号来包裹变量</span></span>
<span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span>
<span class="line"><span class="keyword">import</span> &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span>
<span class="line"><span class="keyword">const</span> RootDom= <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>);</span>
<span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span>
<span class="line"><span class="keyword">let</span> jsx1 = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;a&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span>
<span class="line"><span class="keyword">let</span> b = &#123; <span class="attr">id</span> : <span class="number">2</span> &#125;;</span>
<span class="line"><span class="keyword">let</span> jsx2 = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;b.id&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span>
<span class="line"><span class="keyword">let</span> jsx3 = [<span class="string">'i'</span>,<span class="string">'love'</span>,<span class="string">'react'</span>].map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span>
<span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span>
<span class="line">&#125;);</span>
<span class="line">render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span>
<span class="line"><span class="xml">    &#123;jsx1&#125;&#123;jsx2&#125;&#123;jsx3&#125;</span></span>
<span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, RootDom);</span>
<span class="line"><span class="comment">// 事实上 render 还有第三个参数 callback</span></span>
</pre></td></tr></table></figure>
<h3 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">React</span>,&#123;<span class="type">Component</span>&#125; from <span class="symbol">'reac</span>t';</span>
<span class="line"><span class="keyword">import</span> &#123;render&#125; from <span class="symbol">'react</span>-dom';</span>
<span class="line">const <span class="type">RootDom</span> = document.getElementById(<span class="symbol">'roo</span>t');</span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment"> * pure functional components </span></span>
<span class="line"><span class="comment"> * it must never modify its own props</span></span>
<span class="line"><span class="comment"> */</span></span>
<span class="line"> </span>
<span class="line">const <span class="type">A</span> = (props) =&gt; &#123;</span>
<span class="line">    <span class="keyword">return</span> &lt;div&gt;&#123; props.gender &#125; + &#123; props.name &#125;&lt;/div&gt;</span>
<span class="line">&#125;;</span>
<span class="line">render(&lt;<span class="type">A</span> gender=<span class="symbol">'male</span> name=<span class="symbol">'franki</span>e'/&gt;,<span class="type">RootDom</span>);</span>
<span class="line"></span>
<span class="line"><span class="comment">// tagname  A, ==&gt; 不是传统的html标签，而是个函数</span></span>
<span class="line"><span class="comment">// attributes &#123;   ==&gt; 函数的情况下 attributes === props</span></span>
<span class="line"><span class="comment">//     gender: 'male',</span></span>
<span class="line"><span class="comment">//     name: "frankie"</span></span>
<span class="line"><span class="comment">// &#125;</span></span>
<span class="line"><span class="comment">// children: null</span></span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment"> * class components</span></span>
<span class="line"><span class="comment"> * - Adding Local State to a Class</span></span>
<span class="line"><span class="comment"> * - Adding Lifecycle Methods to a Class</span></span>
<span class="line"><span class="comment"> */</span></span>
<span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">FisstComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span>
<span class="line">   	 constructor() &#123;</span>
<span class="line">       	 <span class="keyword">super</span>()</span>
<span class="line">       	 <span class="keyword">this</span>.state = &#123;</span>
<span class="line">           	 b: <span class="number">1</span></span>
<span class="line">       	 &#125;</span>
<span class="line">   	 &#125;</span>
<span class="line">   	 render() &#123;</span>
<span class="line">       	 <span class="keyword">return</span>(</span>
<span class="line">       	 	 &lt;div&gt;</span>
<span class="line">       	 	 	 <span class="type">I</span> am a component</span>
<span class="line">       	 	 	 &#123;<span class="keyword">this</span>.state.b&#125;</span>
<span class="line">       	 	 &lt;/div&gt;</span>
<span class="line">       	 )</span>
<span class="line">   	 &#125;</span>
<span class="line"> &#125;</span>
<span class="line"> render(&lt;<span class="type">FirstComponent</span> /&gt;,<span class="type">RootDom</span>);</span>
<span class="line"> </span>
<span class="line"> <span class="comment">// class 组件必须有 render 方法</span></span>
<span class="line"> <span class="comment">// class 组件必须继承 Component</span></span>
<span class="line"> </span>
<span class="line"> <span class="comment">// 组件为什么要大写？区分 HTML 和 组件</span></span>
</pre></td></tr></table></figure>
<h3 id="life-cycle"><a href="#life-cycle" class="headerlink" title="life-cycle"></a>life-cycle</h3><p><a href="https://facebook.github.io/react/docs/state-and-lifecycle.html" target="_blank" rel="external">https://facebook.github.io/react/docs/state-and-lifecycle.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 写代码的时候更具有控制力</span></span>
<span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span>
<span class="line"><span class="keyword">import</span> &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span>
<span class="line"><span class="keyword">const</span> RootDom= <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>);</span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FirstComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span>
<span class="line">    <span class="keyword">constructor</span>()&#123;</span>
<span class="line">        <span class="keyword">super</span>();</span>
<span class="line">        <span class="keyword">this</span>.state = &#123;</span>
<span class="line">            b:<span class="number">1</span></span>
<span class="line">        &#125;</span>
<span class="line">    &#125;</span>
<span class="line">    <span class="comment">// shouldComponentUpdate / componentWillReceiveProps / componentDidMount 用得比较多</span></span>
<span class="line">	shouldComponentUpdate()&#123;   <span class="comment">// 组件是不是应该被更新</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'shouldComponentUpdate'</span>);</span>
<span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span>
<span class="line">	&#125;</span>
<span class="line">	componentWillUnmount()&#123;   <span class="comment">// 组件将会移除</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentWillUnmount'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentDidUpdate()&#123;   <span class="comment">// 组件更新好了</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentDidUpdate'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentWillUpdate()&#123;   <span class="comment">// 组件将会更新</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentWillUpdate'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentWillReceiveProps()&#123;   <span class="comment">// 组件获得了新的 props</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentWillReceiveProps'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentWillMount()&#123;   <span class="comment">// 组件将被加载</span></span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentWillMount'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentDidMount()&#123;   <span class="comment">// 组件加载完成</span></span>
<span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">b</span>:<span class="number">1</span>&#125;)</span>
<span class="line">		<span class="built_in">console</span>.log(<span class="string">'componentDidMount'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">    render()&#123;   <span class="comment">// 组件将被渲染</span></span>
<span class="line">    	<span class="built_in">console</span>.log(<span class="string">'render'</span>)</span>
<span class="line">    	<span class="keyword">let</span> a = <span class="string">'10/26'</span></span>
<span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span>
<span class="line"><span class="xml">           	I am a component</span></span>
<span class="line"><span class="xml">           		&#123;a &#125;</span></span>
<span class="line"><span class="xml">                &#123;this.state.b&#125;</span></span>
<span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span>
<span class="line">    &#125;</span>
<span class="line"> &#125;;</span>
<span class="line"></span>
<span class="line">render(<span class="xml"><span class="tag">&lt;<span class="name">FirstComponent</span> /&gt;</span>,RootDom);</span></span>
<span class="line"><span class="xml"></span></span>
<span class="line"><span class="xml">// componentWillMount</span></span>
<span class="line"><span class="xml">// render</span></span>
<span class="line"><span class="xml">// componentDidMount</span></span>
<span class="line"><span class="xml">// shouldComponentUpdate</span></span>
<span class="line"><span class="xml">// componentWillUpdate</span></span>
<span class="line"><span class="xml">// render</span></span>
<span class="line"><span class="xml">// componentDidUpdate</span></span>
</pre></td></tr></table></figure>
<h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;A a='1'&gt; ==&gt; props = &#123;a:'1'&#125;</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> <span class="type">React</span>,&#123;<span class="type">Component</span>&#125; from <span class="symbol">'reac</span>t';</span>
<span class="line"><span class="keyword">import</span> &#123;render&#125; from <span class="symbol">'react</span>-dom';</span>
<span class="line">const <span class="type">RootDom</span>= document.getElementById(<span class="symbol">'roo</span>t');</span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">  render() &#123;</span>
<span class="line">    <span class="keyword">return</span> &lt;div&gt;&#123;<span class="keyword">this</span>.props.gender&#125; + &#123;<span class="keyword">this</span>.props.name&#125;&lt;/div&gt;</span>
<span class="line">  &#125;</span>
<span class="line">&#125;</span>
<span class="line"><span class="comment">/** props.children</span></span>
<span class="line"><span class="comment"> * React uses this.props.children to access a component's children nodes.</span></span>
<span class="line"><span class="comment"> * ==== ! props should be pure === // 不应该做任何修改</span></span>
<span class="line"><span class="comment"> */</span></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span>
<span class="line">    render()&#123;</span>
<span class="line">        <span class="keyword">return</span> (</span>
<span class="line">        &lt;div&gt;</span>
<span class="line">            &#123;<span class="keyword">this</span>.props.children&#125;   <span class="comment">// 如果 render 写成传统的 html 标签，那“我是个孩子”就是 &#123;this.props.children&#125;</span></span>
<span class="line">            &lt;<span class="type">Welcome</span> gender=<span class="symbol">'mal</span>e' name=<span class="symbol">'franki</span>e' /&gt;</span>
<span class="line">        &lt;/div&gt;</span>
<span class="line">        );</span>
<span class="line">    &#125;</span>
<span class="line"> &#125;;</span>
<span class="line">render(&lt;<span class="type">ChildComponent</span>&gt;我是个孩子&lt;/<span class="type">ChildComponent</span>&gt;,<span class="type">RootDom</span>);</span>
<span class="line"></span>
<span class="line"> <span class="comment">// 设置默认值 defaultProps</span></span>
<span class="line"> <span class="comment">// 方法 1</span></span>
<span class="line"> <span class="type">Welcome</span>.defaultProps = &#123;</span>
<span class="line">  	gender: <span class="symbol">'mal</span>e',</span>
<span class="line">  	name: <span class="symbol">'franki</span>e'</span>
<span class="line"> &#125;</span>
<span class="line"> <span class="comment">// 方法 2</span></span>
<span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	static defaultProps = &#123;</span>
<span class="line">       gender: <span class="symbol">'mal</span>e',</span>
<span class="line">  	   name: <span class="symbol">'franki</span>e'</span>
<span class="line">	&#125;</span>
<span class="line"> &#125;</span>
</pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 类型检测</span></span>
<span class="line"><span class="keyword">import</span> <span class="type">PropTypes</span> from <span class="symbol">'prop</span>-types';</span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">static defaultProps = &#123;</span>
<span class="line">      gender: <span class="type">PropTypes</span>.string,</span>
<span class="line"> 	   name: <span class="type">PropTypes</span>.string</span>
<span class="line">&#125;</span>
<span class="line">render()&#123;</span>
<span class="line">     	<span class="keyword">return</span> &lt;div&gt;&#123;<span class="keyword">this</span>.props.gender&#125; + &#123;<span class="keyword">this</span>.props.name&#125;&lt;/div&gt; </span>
<span class="line">&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 假设这里传了数字怎么办？</span></span>
<span class="line"><span class="type">ReactDOM</span>.render(&lt;<span class="type">Welcome</span> gender=<span class="symbol">'023</span>4' name=<span class="symbol">'023</span>4'/&gt;,<span class="type">RootDom</span>)</span>
</pre></td></tr></table></figure>
<p><a href="https://reactjs.org/docs/typechecking-with-proptypes.html" target="_blank" rel="external">https://reactjs.org/docs/typechecking-with-proptypes.html</a></p>
<h3 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h3><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
</pre></td><td class="code"><pre><span class="line">// <span class="built_in">set</span>State 是一个异步的操作</span>
<span class="line">// 改变数据只有一种方法 <span class="built_in">set</span>State</span>
<span class="line">import React,&#123;Component&#125; <span class="keyword">from</span> 'react';</span>
<span class="line">import &#123;render&#125; <span class="keyword">from</span> 'react-dom';</span>
<span class="line">const RootDom= document.getElementById('root');</span>
<span class="line">/**</span>
<span class="line"> * 数据源: <span class="keyword">state</span> + props</span>
<span class="line"> * props: parent ==&gt; child 【pure不能修改】</span>
<span class="line"> * <span class="keyword">state</span>: 自身维护的数据状态</span>
<span class="line"> */</span>
<span class="line">class PropState extends Component&#123;</span>
<span class="line">    constructor()&#123;</span>
<span class="line">        super();</span>
<span class="line">        this.<span class="keyword">state</span>=&#123;a:'I am <span class="keyword">state</span>'&#125;</span>
<span class="line">    &#125;</span>
<span class="line">    click()&#123;</span>
<span class="line">        /**</span>
<span class="line">         * <span class="built_in">set</span>State ==&gt; 本组件重新render</span>
<span class="line">         */</span>
<span class="line">    	this.<span class="built_in">set</span>State(&#123;</span>
<span class="line">    		a:'我更新啦 哈哈哈'</span>
<span class="line">    	&#125;)</span>
<span class="line">    &#125;</span>
<span class="line">    render()&#123;</span>
<span class="line">        return <span class="variable">&lt;div onClick=&#123;()=&gt;</span>this.click()&#125;&gt;</span>
<span class="line">                &#123;this.<span class="keyword">state</span>.a&#125;</span>
<span class="line">                <span class="variable">&lt;A name= &#123;this.state.a&#125; /&gt;</span></span>
<span class="line">              &lt;/div&gt;</span>
<span class="line">    &#125;</span>
<span class="line"> &#125;;</span>
<span class="line">const A = (props) =&gt; &#123;</span>
<span class="line">    return <span class="variable">&lt;div&gt;</span>&#123;props.name&#125;&lt;/div&gt;</span>
<span class="line">&#125;</span>
<span class="line">render(<span class="variable">&lt;PropState/&gt;</span>,RootDom);</span>
</pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 定时器</span></span>
<span class="line"><span class="comment">// 记住在 numount 要取消定时器，要不然很容易会造成内存泄露</span></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Timer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	<span class="keyword">constructor</span>() &#123;</span>
<span class="line">      	<span class="keyword">super</span>()</span>
<span class="line">      	<span class="keyword">this</span>.state = &#123;</span>
<span class="line">          	count: <span class="number">0</span>,</span>
<span class="line">          	time: (<span class="keyword">new</span> <span class="built_in">Date</span>()).toLocaleTimeString()</span>
<span class="line">      	&#125;</span>
<span class="line">	&#125;</span>
<span class="line">	tick() &#123;</span>
<span class="line">        <span class="keyword">this</span>.setState(&#123;</span>
<span class="line">            count: <span class="number">1</span>,</span>
<span class="line">            time: (<span class="keyword">new</span> <span class="built_in">Date</span>()).toLocaleTimeString()</span>
<span class="line">        &#125;)</span>
<span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.count)  <span class="comment">// 0,因为 setState() 是异步函数    	</span></span>
<span class="line">	&#125;</span>
<span class="line">	componentWillMount() &#123;</span>
<span class="line">		<span class="keyword">this</span>.interval = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.tick(),<span class="number">1000</span>)</span>
<span class="line">	&#125;</span>
<span class="line">	componentWillUnmount() &#123;</span>
<span class="line">      	clearInterval(<span class="keyword">this</span>.interval)</span>
<span class="line">	&#125;</span>
<span class="line">	shouldComponentUpate(nextProps, nextState) &#123;</span>
<span class="line">      	<span class="keyword">return</span> <span class="literal">true</span>;</span>
<span class="line">	&#125;</span>
<span class="line">	render() &#123;</span>
<span class="line">      	<span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>the time is &#123;this.state.time&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"> </span>
<span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Timer</span> /&gt;</span>,RootDom)</span></span>
</pre></td></tr></table></figure>
<h3 id="值得注意的地方"><a href="#值得注意的地方" class="headerlink" title="值得注意的地方"></a>值得注意的地方</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 绑定 this 的方法</span></span>
<span class="line"><span class="comment">// 箭头函数和 constructor 都可以</span></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	constructor() &#123;</span>
<span class="line">      	<span class="keyword">super</span>()</span>
<span class="line">      	<span class="keyword">this</span>.state = &#123;</span>
<span class="line">          	name: <span class="symbol">'franki</span>e'</span>
<span class="line">      	&#125;</span>
<span class="line">      	<span class="comment">// 构造函数绑 this</span></span>
<span class="line">      	<span class="comment">// this.handleClick = this.handleClick.bind(this)</span></span>
<span class="line">	&#125;</span>
<span class="line">	<span class="comment">// 箭头函数绑 this</span></span>
<span class="line">	handleClick = () =&gt; &#123;</span>
<span class="line">      	alert(<span class="keyword">this</span>.state.name)</span>
<span class="line">	&#125;</span>
<span class="line">	render() &#123;</span>
<span class="line">      	<span class="keyword">return</span> (&lt;div&gt;my name is &#123;<span class="keyword">this</span>.state.name&#125;&lt;/div&gt;)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 最后一种 ReactDOM.render(&lt;Name onClick=&#123;this.handleClick.bind(this)&#125;/&gt;,RootDom)</span></span>
<span class="line"><span class="comment">// 这种是不建议的，会触发 componentWillReceiveProps 和 shouldComponentUpdate，假如在定时器里，子组件就会一直 render</span></span>
<span class="line"><span class="comment">// 也不能在 render 里用箭头函数</span></span>
<span class="line"><span class="type">ReactDOM</span>.render(&lt;<span class="type">Name</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;/&gt;,<span class="type">RootDom</span>)</span>
</pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 阻止事件冒泡</span></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">先考虑一个东西</span></span>
<span class="line"><span class="comment">写在 React 的 div 和原生的 div 是不一样的</span></span>
<span class="line"><span class="comment">那它们的 event 是一样的吗？</span></span>
<span class="line"><span class="comment">// </span></span>
<span class="line"><span class="comment">&lt;div onclick=""&gt;&lt;/div&gt;</span></span>
<span class="line"><span class="comment">function test(event)&#123;</span></span>
<span class="line"><span class="comment">  return false</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">// react</span></span>
<span class="line"><span class="comment">handleClick = (event) =&gt; &#123;</span></span>
<span class="line"><span class="comment">  </span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">其实是不一样的</span></span>
<span class="line"><span class="comment">react 的 event 是被封装过的，叫做 SyntheticEvent 能实现百分之九十的 event 原生事件 </span></span>
<span class="line"><span class="comment">通过 ev.nativeEvent === event 封装</span></span>
<span class="line"><span class="comment">ev.nativeEvent.stopImmediatePropagation()</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">handleClick = (event) =&gt; &#123;</span></span>
<span class="line"><span class="comment">  setTimeout(()=&gt; &#123;</span></span>
<span class="line"><span class="comment">    console.log(event.type)</span></span>
<span class="line"><span class="comment">  &#125;)</span></span>
<span class="line"><span class="comment">  console.log(event.type)</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">react 的 event 是不能异步执行的</span></span>
<span class="line"><span class="comment">react 的 event 有一个事件值，触发完成之后就会销毁</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	constructor() &#123;</span>
<span class="line">      	<span class="keyword">super</span>()</span>
<span class="line">      	<span class="keyword">this</span>.state = &#123;</span>
<span class="line">          	name: <span class="symbol">'franki</span>e'</span>
<span class="line">      	&#125;</span>
<span class="line">	&#125;</span>
<span class="line">	handleClick() &#123;</span>
<span class="line">      	alert(<span class="keyword">this</span>.state.name)</span>
<span class="line">      	<span class="comment">// 可以直接调用</span></span>
<span class="line">        <span class="comment">// event.stopPropagation()</span></span>
<span class="line">        <span class="comment">// event.preventDefault()</span></span>
<span class="line">	&#125;	</span>
<span class="line">	render() &#123;</span>
<span class="line">      	<span class="keyword">return</span> (&lt;div&gt;my name is &#123;<span class="keyword">this</span>.state.name&#125;&lt;/div&gt;)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="type">ReactDOM</span>.render(&lt;<span class="type">Name</span> onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)&#125;/&gt;,<span class="type">RootDom</span>)</span>
</pre></td></tr></table></figure>
<h3 id="ref-和-DOM"><a href="#ref-和-DOM" class="headerlink" title="ref 和 DOM"></a>ref 和 DOM</h3><p><a href="https://reactjs.org/docs/refs-and-the-dom.html" target="_blank" rel="external">https://reactjs.org/docs/refs-and-the-dom.html</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 利用 ref 操作 DOM</span></span>
<span class="line"><span class="comment">// react 不建议直接操作 DOM 元素，性能不好</span></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> <span class="title">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	<span class="keyword">constructor</span>() &#123;</span>
<span class="line">      	<span class="keyword">super</span>()</span>
<span class="line">      	<span class="keyword">this</span>.state = &#123;</span>
<span class="line">          	name: <span class="string">'frankie'</span></span>
<span class="line">      	&#125;</span>
<span class="line">	&#125;</span>
<span class="line">	handleClick = (event) =&gt; &#123;</span>
<span class="line">      	<span class="comment">// var el = document.getElementById('content')</span></span>
<span class="line">      	<span class="comment">// this.refs.style.color = 'red'  这是旧的</span></span>
<span class="line">      	<span class="keyword">this</span>.contentRef.style.color = <span class="string">'red'</span></span>
<span class="line">	&#125;	</span>
<span class="line">	render() &#123;</span>
<span class="line">      	<span class="keyword">return</span> (</span>
<span class="line">      	<span class="comment">// &lt;div ref="content"&gt;  这是旧的</span></span>
<span class="line">      	&lt;div onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span>
<span class="line">            &lt;div ref=&#123;(content) =&gt; &#123;<span class="keyword">this</span>.contentRef = content&#125;&#125;&gt;</span>
<span class="line">            my name <span class="keyword">is</span> &#123;<span class="keyword">this</span>.state.name&#125;</span>
<span class="line">            &lt;/div&gt;</span>
<span class="line">      	&lt;/div&gt;)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">ReactDOM.render(&lt;Name /&gt;,RootDom)</span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">其实上面这种做法 React 是不推荐的</span></span>
<span class="line"><span class="comment">class Name extends Component &#123;</span></span>
<span class="line"><span class="comment">	constructor() &#123;</span></span>
<span class="line"><span class="comment">      	super()</span></span>
<span class="line"><span class="comment">      	this.state = &#123;</span></span>
<span class="line"><span class="comment">      		color: '',</span></span>
<span class="line"><span class="comment">          	name: 'frankie'</span></span>
<span class="line"><span class="comment">      	&#125;</span></span>
<span class="line"><span class="comment">	&#125;</span></span>
<span class="line"><span class="comment">	handleClick(event)&#123;</span></span>
<span class="line"><span class="comment">		this.setState(&#123;</span></span>
<span class="line"><span class="comment">          	color: 'red'</span></span>
<span class="line"><span class="comment">		&#125;)</span></span>
<span class="line"><span class="comment">	&#125;	</span></span>
<span class="line"><span class="comment">	render() &#123;</span></span>
<span class="line"><span class="comment">      	return (</span></span>
<span class="line"><span class="comment">      	/*</span></span>
<span class="line"><span class="comment">      	直接在标签上使用style属性时，</span></span>
<span class="line"><span class="comment">      	要写成style=&#123;&#123;&#125;&#125;是两个大括号，</span></span>
<span class="line"><span class="comment">      	外层大括号是告知jsx这里是js语法，</span></span>
<span class="line"><span class="comment">      	和真实DOM不同的是，属性值不能是字符串而必须为对象，</span></span>
<span class="line"><span class="comment">      	需要注意的是属性名同样需要驼峰命名法。即margin-top要写成marginTop。</span></span>
<span class="line"><span class="comment">      	*/</span></span>
<span class="line">      	&lt;div style=&#123;&#123;color: <span class="keyword">this</span>.state.color&#125;&#125; onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)&#125;&gt;</span>
<span class="line">            &lt;div ref=&#123;(content) =&gt; &#123;<span class="keyword">this</span>.contentRef = content&#125;&#125;&gt;</span>
<span class="line">            my name <span class="keyword">is</span> &#123;<span class="keyword">this</span>.state.name&#125;</span>
<span class="line">            &lt;/div&gt;</span>
<span class="line">      	&lt;/div&gt;)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">ReactDOM.render(&lt;Name /&gt;,RootDom)</span>
<span class="line"></span>
<span class="line">*/</span>
</pre></td></tr></table></figure>
<h3 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
<span class="line">63</span>
<span class="line">64</span>
<span class="line">65</span>
<span class="line">66</span>
<span class="line">67</span>
<span class="line">68</span>
<span class="line">69</span>
<span class="line">70</span>
<span class="line">71</span>
<span class="line">72</span>
<span class="line">73</span>
<span class="line">74</span>
<span class="line">75</span>
<span class="line">76</span>
<span class="line">77</span>
<span class="line">78</span>
<span class="line">79</span>
<span class="line">80</span>
<span class="line">81</span>
<span class="line">82</span>
<span class="line">83</span>
<span class="line">84</span>
<span class="line">85</span>
<span class="line">86</span>
<span class="line">87</span>
<span class="line">88</span>
<span class="line">89</span>
<span class="line">90</span>
<span class="line">91</span>
<span class="line">92</span>
<span class="line">93</span>
<span class="line">94</span>
<span class="line">95</span>
<span class="line">96</span>
<span class="line">97</span>
<span class="line">98</span>
<span class="line">99</span>
<span class="line">100</span>
<span class="line">101</span>
<span class="line">102</span>
<span class="line">103</span>
</pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span>
<span class="line">	<span class="keyword">constructor</span>() &#123;</span>
<span class="line">      	<span class="keyword">super</span>()</span>
<span class="line">      	<span class="keyword">this</span>.state = &#123;</span>
<span class="line">             <span class="keyword">let</span> arr = [&#123;</span>
<span class="line">              id: <span class="string">'1'</span>,</span>
<span class="line">              name: <span class="string">'dalao1'</span></span>
<span class="line">            &#125;, &#123;</span>
<span class="line">              id: <span class="string">'2'</span>,</span>
<span class="line">              name: <span class="string">'dalao2'</span></span>
<span class="line">            &#125;, &#123;</span>
<span class="line">              id: <span class="string">'3'</span>,</span>
<span class="line">              name: <span class="string">'dalao3'</span></span>
<span class="line">            &#125;]         	</span>
<span class="line">      	&#125;</span>
<span class="line">	&#125;</span>
<span class="line">	render() &#123;</span>
<span class="line">      	<span class="keyword">return</span> (</span>
<span class="line">      	&lt;div onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span>
<span class="line">			&lt;ul&gt;</span>
<span class="line">				&#123;arr.map(<span class="function">(<span class="params">item, i</span>) =&gt;</span> &#123;</span>
<span class="line">					<span class="comment">// return &lt;li key=&#123;i&#125;&gt;&#123;item.name&#125;&lt;/li&gt;</span></span>
<span class="line">					<span class="comment">// 这个 key 的作用是见下面</span></span>
<span class="line">                  	<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span>
<span class="line">				&#125;)&#125;</span>
<span class="line">			&lt;<span class="regexp">/ul&gt;</span></span>
<span class="line"><span class="regexp">      	&lt;/</span>div&gt;)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Name</span> /&gt;</span>,RootDom)</span></span>
<span class="line"><span class="xml"></span></span>
<span class="line"><span class="xml">/*</span></span>
<span class="line"><span class="xml">key 的作用 react 做 diff 算法的时候使用</span></span>
<span class="line"><span class="xml">如果 key 能保持稳定，DOM 内容不变就可以避免重新渲染</span></span>
<span class="line"><span class="xml">key 不要用 index 不要用随机数</span></span>
<span class="line"><span class="xml"></span></span>
<span class="line"><span class="xml">class Name extends React.Component &#123;</span></span>
<span class="line"><span class="xml">	constructor() &#123;</span></span>
<span class="line"><span class="xml">      	super()</span></span>
<span class="line"><span class="xml">      	this.state = &#123;</span></span>
<span class="line"><span class="xml">             people : [&#123;</span></span>
<span class="line"><span class="xml">              id: '1',</span></span>
<span class="line"><span class="xml">              name: 'dalao1'</span></span>
<span class="line"><span class="xml">            &#125;, &#123;</span></span>
<span class="line"><span class="xml">              id: '2',</span></span>
<span class="line"><span class="xml">              name: 'dalao2'</span></span>
<span class="line"><span class="xml">            &#125;, &#123;</span></span>
<span class="line"><span class="xml">              id: '3',</span></span>
<span class="line"><span class="xml">              name: 'dalao3'</span></span>
<span class="line"><span class="xml">            &#125;]         	</span></span>
<span class="line"><span class="xml">      	&#125;</span></span>
<span class="line"><span class="xml">	&#125;</span></span>
<span class="line"><span class="xml">	handleClick(event) &#123;</span></span>
<span class="line"><span class="xml">		// 这里要用深拷贝</span></span>
<span class="line"><span class="xml">		let people = this.state.people</span></span>
<span class="line"><span class="xml">		let newPeople = people.map((person =&gt; &#123;</span></span>
<span class="line"><span class="xml">          	let newPerson = &#123;...person&#125;  // 这里相当于浅拷贝</span></span>
<span class="line"><span class="xml">          	if (newPerson.id == '2') &#123;</span></span>
<span class="line"><span class="xml">              	newPerson.name += 'haha'</span></span>
<span class="line"><span class="xml">          	&#125;</span></span>
<span class="line"><span class="xml">          	return newPeople  // 返回了新的地址相当于深拷贝</span></span>
<span class="line"><span class="xml">		&#125;))</span></span>
<span class="line"><span class="xml">		this.setState(&#123;</span></span>
<span class="line"><span class="xml">			people : newPeople</span></span>
<span class="line"><span class="xml">		&#125;)</span></span>
<span class="line"><span class="xml">	&#125;	</span></span>
<span class="line"><span class="xml">	render() &#123;</span></span>
<span class="line"><span class="xml">      	return (</span></span>
<span class="line">      	&lt;div onClick=&#123;this.handleClick.bind(this)&#125;&gt;</span>
<span class="line">			&lt;ul&gt;</span>
<span class="line">				&#123;this.state.people.map((item, i) =&gt; &#123;</span>
<span class="line">					// return &lt;Person key=&#123;Math.random() * 100&#125; item=&#123;item&#125;&gt;&lt;/Person&gt;</span>
<span class="line">					// 如果像上面一样，因为 key 是不一样的，所以 react 以为这个组件没有使用过，要重新构造一份</span>
<span class="line">					return &lt;Person key=&#123;i&#125; item=&#123;item&#125;&gt;&lt;/Person&gt;</span>
<span class="line">				&#125;)&#125;</span>
<span class="line">			&lt;/ul&gt;</span>
<span class="line"><span class="xml">      	<span class="tag">&lt;/<span class="name">div</span>&gt;</span>)</span></span>
<span class="line"><span class="xml">	&#125;</span></span>
<span class="line"><span class="xml">&#125;</span></span>
<span class="line"><span class="xml"></span></span>
<span class="line"><span class="xml">class Person extends React.Component&#123;</span></span>
<span class="line"><span class="xml">	shouldComponentUpdate(nextProps, nextState) &#123;</span></span>
<span class="line"><span class="xml">      	return nextProps.item.name !== this.props.item.name</span></span>
<span class="line"><span class="xml">      	// 如果不用深拷贝，nextProps.item.name === this.props.item.name 是 true，相等的原因是因为 item 是引用类型</span></span>
<span class="line"><span class="xml">	&#125;</span></span>
<span class="line"><span class="xml">  	render()&#123;</span></span>
<span class="line"><span class="xml">  		console.log('render' + this.props.item.id)</span></span>
<span class="line"><span class="xml">  		/* </span></span>
<span class="line"><span class="xml">  		这里打印的是</span></span>
<span class="line"><span class="xml">  		render1</span></span>
<span class="line"><span class="xml">  		render2</span></span>
<span class="line"><span class="xml">  		render3</span></span>
<span class="line"><span class="xml">  		避免 1 3 渲染的方法是</span></span>
<span class="line"><span class="xml">  		key 值要稳定</span></span>
<span class="line"><span class="xml">  		深拷贝</span></span>
<span class="line"><span class="xml">  		*/</span></span>
<span class="line"><span class="xml">      	return <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;this.props.item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span>
<span class="line"><span class="xml">  	&#125;</span></span>
<span class="line"><span class="xml">&#125;</span></span>
<span class="line"><span class="xml"></span></span>
<span class="line"><span class="xml">ReactDOM.render(<span class="tag">&lt;<span class="name">Name</span> /&gt;</span>,mountNode)</span></span>
<span class="line"><span class="xml">*/</span></span>
</pre></td></tr></table></figure>
<p><a href="https://segmentfault.com/a/1190000006752076" target="_blank" rel="external">JavaScript 深入了解基本类型和引用类型的值</a></p>
<h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
<span class="line">63</span>
<span class="line">64</span>
<span class="line">65</span>
<span class="line">66</span>
<span class="line">67</span>
<span class="line">68</span>
<span class="line">69</span>
<span class="line">70</span>
<span class="line">71</span>
<span class="line">72</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">方法有：三元 if else 组件 方法 &amp;&amp;判断</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span>
<span class="line">  	render()&#123;</span>
<span class="line">  		let isLogin = <span class="keyword">this</span>.props.isLogin</span>
<span class="line">  		let comp = <span class="literal">null</span></span>
<span class="line">  		<span class="keyword">if</span>(isLogin)&#123;</span>
<span class="line">          comp = &lt;<span class="type">Logout</span> /&gt;</span>
<span class="line">  		&#125;<span class="keyword">else</span>&#123;</span>
<span class="line">          comp = &lt;<span class="type">Login</span> /&gt;</span>
<span class="line">  		&#125;</span>
<span class="line">      	<span class="keyword">return</span>(&lt;div&gt;</span>
<span class="line">      		&#123;comp&#125;</span>
<span class="line">      		<span class="comment">// &#123;isLogin ? &lt;Logout /&gt; : &lt;Login /&gt;&#125;  // 主要用三元运算</span></span>
<span class="line">      	&lt;/div&gt;)</span>
<span class="line">  	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span>
<span class="line">  	render()&#123;</span>
<span class="line">      	<span class="keyword">return</span> &lt;div&gt;login&lt;/div&gt;</span>
<span class="line">  	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logout</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span>
<span class="line">  	render()&#123;</span>
<span class="line">      	<span class="keyword">return</span> &lt;div&gt;logout&lt;/div&gt;</span>
<span class="line">  	&#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="type">ReactDOM</span>.render(&lt;<span class="type">Name</span> isLogin=&#123;<span class="literal">true</span>&#125;/&gt;,mountNode)</span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">可以封装成一个组件</span></span>
<span class="line"><span class="comment">function SignIn(isLogin) &#123;</span></span>
<span class="line"><span class="comment">  	if(isLogin)&#123;</span></span>
<span class="line"><span class="comment">      return &lt;Logout/&gt;</span></span>
<span class="line"><span class="comment">  	&#125;else&#123;</span></span>
<span class="line"><span class="comment">      return &lt;Login/&gt;</span></span>
<span class="line"><span class="comment">  	&#125;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">// 在 render 写</span></span>
<span class="line"><span class="comment">render()&#123;</span></span>
<span class="line"><span class="comment">  return(&lt;SignIn isLogin=&#123;isLogin&#125;/&gt;)</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">也可以做成一个方法</span></span>
<span class="line"><span class="comment">getLogIn(isLogin) &#123;</span></span>
<span class="line"><span class="comment">  if(isLogin)&#123;</span></span>
<span class="line"><span class="comment">    return &lt;Logout /&gt;</span></span>
<span class="line"><span class="comment">  &#125;else&#123;</span></span>
<span class="line"><span class="comment">    return &lt;login/&gt;</span></span>
<span class="line"><span class="comment">  &#125;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">render()&#123;</span></span>
<span class="line"><span class="comment">  return(&lt;div&gt;</span></span>
<span class="line"><span class="comment">  	&#123;this.getLogin(isLogin)&#125;</span></span>
<span class="line"><span class="comment">  &lt;/div&gt;)</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">还有一种用 &amp;&amp; 判断</span></span>
<span class="line"><span class="comment">&#123;isLogin &amp;&amp; &lt;Logout/&gt;&#125;</span></span>
<span class="line"><span class="comment">&#123;isLogin &amp;&amp; &lt;LoginIn/&gt;&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
</pre></td></tr></table></figure>
<h3 id="HOC"><a href="#HOC" class="headerlink" title="HOC"></a>HOC</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
<span class="line">63</span>
<span class="line">64</span>
<span class="line">65</span>
<span class="line">66</span>
<span class="line">67</span>
<span class="line">68</span>
<span class="line">69</span>
<span class="line">70</span>
<span class="line">71</span>
<span class="line">72</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">传一个组件出一个组件</span></span>
<span class="line"><span class="comment">其实可以理解为一个给基础组件加方法的处理器</span></span>
<span class="line"><span class="comment">比如说有两个组件 Ad1 Ad2 他们有 abc 三个方法</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">Ad1Component&#123;</span></span>
<span class="line"><span class="comment">  a()&#123;&#125;;b()&#123;&#125;;c()&#123;&#125;;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">Ad2Component&#123;</span></span>
<span class="line"><span class="comment">  a()&#123;&#125;;b()&#123;&#125;;c()&#123;&#125;;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">那我们可以把方法抽离出一个 Basic 组件</span></span>
<span class="line"><span class="comment">BasicComponent&#123;</span></span>
<span class="line"><span class="comment">  a()&#123;&#125;;b()&#123;&#125;;c()&#123;&#125;;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment"></span></span>
<span class="line"><span class="comment">然后写到 HOC 转换</span></span>
<span class="line"><span class="comment">function wrapper(WrapperComponent)&#123;</span></span>
<span class="line"><span class="comment">  return BasicComponent&#123;</span></span>
<span class="line"><span class="comment">    a()&#123;&#125;;b()&#123;&#125;;c()&#123;&#125;;</span></span>
<span class="line"><span class="comment">    render()&#123;</span></span>
<span class="line"><span class="comment">      return &lt;WrapperComponent /&gt;</span></span>
<span class="line"><span class="comment">    &#125;</span></span>
<span class="line"><span class="comment">  &#125;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 写个例子</span></span>
<span class="line"><span class="comment">// 在 input 组件的名字改变的时候加上一些日志的方法但是不能 input 组件上写（为什么会有这个需求？因为有可能这个组件不是你自己写的）</span></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">想到一个方法用 prototype 但是会影响原型链</span></span>
<span class="line"><span class="comment"> function logProps(InputComponent) &#123;</span></span>
<span class="line"><span class="comment">    InputComponent.prototype.componentWillReceiveProps = function(nextProps, nextState) &#123;</span></span>
<span class="line"><span class="comment">      console.log('============')</span></span>
<span class="line"><span class="comment">      console.log('Current props: ', this.props);</span></span>
<span class="line"><span class="comment">      console.log('Next props: ', nextProps);</span></span>
<span class="line"><span class="comment">    &#125;;</span></span>
<span class="line"><span class="comment">    return InputComponent;</span></span>
<span class="line"><span class="comment">&#125;</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 正确的方法应该是利用 HOC 封装方法</span></span>
<span class="line"></span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InputComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span>
<span class="line">    componentWillReceiveProps() &#123;</span>
<span class="line"></span>
<span class="line">    &#125;</span>
<span class="line">    render() &#123;</span>
<span class="line">        <span class="keyword">return</span> &lt;div&gt;&#123;<span class="keyword">this</span>.props.name&#125;&lt;/div&gt;</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">function logProps(<span class="type">WrappedComponent</span>) &#123;</span>
<span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;  <span class="comment">// 匿名组件，要实现的共有方法都在这里做</span></span>
<span class="line">      componentWillReceiveProps(nextProps) &#123;    </span>
<span class="line">        console.log(<span class="symbol">'Current</span> props: ', <span class="keyword">this</span>.props);</span>
<span class="line">        console.log(<span class="symbol">'Next</span> props: ', nextProps);</span>
<span class="line">      &#125;</span>
<span class="line">      render() &#123;</span>
<span class="line">        <span class="keyword">return</span> &lt;<span class="type">WrappedComponent</span> &#123;...<span class="keyword">this</span>.props&#125; /&gt;;</span>
<span class="line">      &#125;</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">const <span class="type">EnhancedComponent</span> = logProps(<span class="type">InputComponent</span>);</span>
<span class="line"></span>
<span class="line"> let name = <span class="symbol">'dala</span>o';</span>
<span class="line"> setInterval(() =&gt; &#123;</span>
<span class="line">    name += ' hah';</span>
<span class="line">    <span class="type">ReactDOM</span>.render(&lt;<span class="type">EnhancedComponent</span> name=&#123;name&#125; /&gt;, document.getElementById(<span class="symbol">'roo</span>t'));</span>
<span class="line"> &#125;, <span class="number">1000</span>)</span>
</pre></td></tr></table></figure>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p><a href="http://www.redux.org.cn/" target="_blank" rel="external">Redux 官方文档</a></p>
<p><a href="https://github.com/slashhuang/redux-annotation" target="_blank" rel="external">https://github.com/slashhuang/redux-annotation</a></p>
<p><img src="https://ooo.0o0.ooo/2017/11/04/59fd9c6002509.jpg" alt=""></p>
<h3 id="第一个简单的例子"><a href="#第一个简单的例子" class="headerlink" title="第一个简单的例子"></a>第一个简单的例子</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="external">Object.assign()</a></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span>
<span class="line"><span class="keyword">const</span> initState = &#123;&#125;</span>
<span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span>
<span class="line">	<span class="keyword">return</span> action</span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">const</span> store = createStore(reducer, initState)</span>
<span class="line">store.dispatch(&#123;</span>
<span class="line">	<span class="keyword">type</span>: <span class="string">'init'</span>,</span>
<span class="line">	payload: <span class="string">'hello world'</span></span>
<span class="line">&#125;)</span>
<span class="line"><span class="built_in">console</span>.log(store.getState())</span>
<span class="line"></span>
<span class="line"><span class="comment">// redux 的整体架构</span></span>
<span class="line"><span class="comment">// action (动作) ===&gt; 发起 AJAX</span></span>
<span class="line"><span class="comment">// reducer (Handler处理器) ===&gt; JSON 处理</span></span>
<span class="line"><span class="comment">// state (最后的状态) ===&gt; JSON 保存起来</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 通常从后端拉数据的流程是这样的</span></span>
<span class="line"><span class="comment">// AJAX ===&gt; JSON ===&gt; UI</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 所以上面这个代码拆分开来就是</span></span>
<span class="line"><span class="keyword">const</span> action = &#123;</span>
<span class="line">  	<span class="keyword">type</span>: <span class="string">'init'</span>,</span>
<span class="line">  	payload: <span class="string">'hello world'</span>,</span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;  <span class="comment">// state 是前一次保存的数据状态</span></span>
<span class="line">  	<span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, state, action);  <span class="comment">// 生成下一个数据状态</span></span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">const</span> store = createStore(reducer, initState)</span>
<span class="line">store.dispatch(action)</span>
<span class="line"><span class="built_in">console</span>.log(store.getState())</span>
</pre></td></tr></table></figure>
<h3 id="createStore-源码"><a href="#createStore-源码" class="headerlink" title="createStore 源码"></a>createStore 源码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要注意的是第一个参数和第二个参数（reducer, 初始化的 state）</span></span>
<span class="line">export <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span><span class="params">(reducer, preloadedState, enhancer)</span></span></span>
<span class="line"><span class="function"></span></span>
<span class="line"><span class="function">/*</span></span>
<span class="line"><span class="function">判断...</span></span>
<span class="line"><span class="function">*/</span></span>
<span class="line"><span class="function"></span></span>
<span class="line"><span class="function"><span class="title">var</span> <span class="title">currentReducer</span> = <span class="title">reducer</span></span>;  <span class="comment">// 当前的处理器</span></span>
<span class="line"><span class="keyword">var</span> currentState = preloadedState;   <span class="comment">// 当前的state ===&gt; 初始化的 state</span></span>
<span class="line"><span class="keyword">var</span> currentListeners = []; </span>
<span class="line"><span class="keyword">var</span> nextListeners = currentListeners;</span>
<span class="line"><span class="keyword">var</span> isDispatching = <span class="keyword">false</span>;  <span class="comment">// 不执行</span></span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">往下看</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getState</span><span class="params">()</span> </span>&#123;</span>
<span class="line">	<span class="keyword">return</span> currentState;  <span class="comment">// 直接 return currentState</span></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">往下看</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span><span class="params">(action)</span> </span>&#123;</span>
<span class="line"></span>
<span class="line">    <span class="keyword">try</span> &#123;</span>
<span class="line">      isDispatching = <span class="keyword">true</span>;</span>
<span class="line">      currentState = currentReducer(currentState, action);  </span>
<span class="line">      <span class="comment">// 用当前的 reducer 处理当前的 state 和 action</span></span>
<span class="line">      <span class="comment">// 只要 dispatch(action) 就会处理一遍生成一个 state</span></span>
<span class="line">    &#125; <span class="keyword">finally</span> &#123;</span>
<span class="line">      isDispatching = <span class="keyword">false</span>;</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> listeners = currentListeners = nextListeners;</span>
<span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; listeners.length; i++) &#123;</span>
<span class="line">      <span class="keyword">var</span> listener = listeners[i];</span>
<span class="line">      listener();</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    <span class="keyword">return</span> action;  <span class="comment">// 返回一个 action</span></span>
<span class="line">  &#125;</span>
<span class="line">  </span>
<span class="line"><span class="comment">/*</span></span>
<span class="line"><span class="comment">往下看</span></span>
<span class="line"><span class="comment">*/</span></span>
<span class="line"></span>
<span class="line">  <span class="keyword">return</span> _ref2 = &#123;</span>
<span class="line">    dispatch: dispatch,</span>
<span class="line">    subscribe: subscribe,</span>
<span class="line">    getState: getState,</span>
<span class="line">    replaceReducer: replaceReducer</span>
<span class="line">  &#125;, _ref2[$$observable] = observable, _ref2;</span>
<span class="line">  <span class="comment">// 最后也是返回出来</span></span>
</pre></td></tr></table></figure>
<h3 id="回看例子分析-createStore-源码"><a href="#回看例子分析-createStore-源码" class="headerlink" title="回看例子分析 createStore 源码"></a>回看例子分析 createStore 源码</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
<span class="line">63</span>
<span class="line">64</span>
<span class="line">65</span>
<span class="line">66</span>
<span class="line">67</span>
<span class="line">68</span>
<span class="line">69</span>
<span class="line">70</span>
<span class="line">71</span>
<span class="line">72</span>
<span class="line">73</span>
<span class="line">74</span>
<span class="line">75</span>
<span class="line">76</span>
<span class="line">77</span>
<span class="line">78</span>
<span class="line">79</span>
<span class="line">80</span>
<span class="line">81</span>
<span class="line">82</span>
<span class="line">83</span>
<span class="line">84</span>
<span class="line">85</span>
<span class="line">86</span>
<span class="line">87</span>
<span class="line">88</span>
<span class="line">89</span>
<span class="line">90</span>
<span class="line">91</span>
<span class="line">92</span>
<span class="line">93</span>
<span class="line">94</span>
<span class="line">95</span>
<span class="line">96</span>
<span class="line">97</span>
<span class="line">98</span>
<span class="line">99</span>
<span class="line">100</span>
<span class="line">101</span>
<span class="line">102</span>
<span class="line">103</span>
</pre></td><td class="code"><pre><span class="line">import &#123; createStore &#125; from <span class="string">'redux'</span></span>
<span class="line">const initState = &#123;&#125;</span>
<span class="line">const action = &#123;</span>
<span class="line">  	<span class="built_in">type</span>: <span class="string">'init'</span>,</span>
<span class="line">  	payload: <span class="string">'hello world'</span>,</span>
<span class="line">&#125;</span>
<span class="line">const reducer = (state, action) =&gt; &#123;   // currentState = currentReducer(currentState, action);  </span>
<span class="line">  	<span class="keyword">return</span> Object.assign(&#123;&#125;, state, action);  // 当前的数据状态</span>
<span class="line">&#125;</span>
<span class="line">debugger</span>
<span class="line">const store = createStore(reducer, initState)  // reducer = (state, action) =&gt; &#123;...&#125;, initState = &#123;&#125;</span>
<span class="line">debugger</span>
<span class="line">store.dispatch(action)  // 所以 store 有 dispatch 方法</span>
<span class="line">console.<span class="built_in">log</span>(store.getState())  // <span class="keyword">return</span> currentState</span>
<span class="line">// Object &#123;<span class="built_in">type</span>: <span class="string">"init"</span>, payload: <span class="string">"hello world"</span>&#125;</span>
<span class="line"></span>
<span class="line">// debugger 看过程</span>
<span class="line">// var currentReducer = reducer;  // currentReducer = <span class="function"><span class="keyword">function</span> <span class="title">reducer</span><span class="params">(state, action)</span></span>, reducer = <span class="function"><span class="keyword">function</span> <span class="title">reducer</span><span class="params">(state, action)</span></span></span>
<span class="line">// var currentState = preloadedState;  // currentState = Object &#123;&#125;, preloadedState = Object &#123;&#125;</span>
<span class="line">  </span>
<span class="line">/*</span>
<span class="line">跳到 dispatch <span class="keyword">return</span> 一个 API 集合</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line">/*</span>
<span class="line">下一个 debugger</span>
<span class="line">currentState = currentReducer(currentState, action); 进去看一下</span>
<span class="line"><span class="keyword">return</span> Object.assign(&#123;&#125;, state, action);  做一个覆盖</span>
<span class="line">currentState 变成了 Object &#123;<span class="built_in">type</span>: <span class="string">"init"</span>, payload: <span class="string">"hello world"</span>&#125;</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line">/*</span>
<span class="line">看一下 console.<span class="built_in">log</span>(store.getState())</span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getState</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">return</span> currentState; // 返回 currentState</span>
<span class="line">&#125;</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line"><span class="comment">--------------------------------------------------------------------</span></span>
<span class="line"></span>
<span class="line">// 修改一下代码</span>
<span class="line">import &#123; createStore &#125; from <span class="string">'redux'</span></span>
<span class="line">const initState = &#123;&#125;</span>
<span class="line">const action = &#123;</span>
<span class="line">  	<span class="built_in">type</span>: <span class="string">'init'</span>,</span>
<span class="line">  	payload: <span class="string">'hello world'</span>,</span>
<span class="line">&#125;</span>
<span class="line">const reducer = (state, action) =&gt; &#123;</span>
<span class="line">  	<span class="keyword">return</span> Object.assign(&#123;&#125;, state, action);</span>
<span class="line">&#125;</span>
<span class="line">const store = createStore(reducer, initState)</span>
<span class="line">debugger</span>
<span class="line">store.subscribe(() =&gt; &#123;</span>
<span class="line">  	console.<span class="built_in">log</span>(<span class="string">'我注册啦'</span>)</span>
<span class="line">&#125;)</span>
<span class="line">store.dispatch(action)</span>
<span class="line">console.<span class="built_in">log</span>(store.getState())</span>
<span class="line"></span>
<span class="line">// store.subscribe 进去看看</span>
<span class="line">/*</span>
<span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">subscribe</span><span class="params">(listener)</span></span> &#123;</span>
<span class="line">	</span>
<span class="line">	//...</span>
<span class="line">	</span>
<span class="line">    nextListeners.push(listener);    // nextListeners 是一个长度为零的数组，把 listener push 进去</span>
<span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">unsubscribe</span><span class="params">()</span></span> &#123;</span>
<span class="line">    	// ...</span>
<span class="line">    &#125;;</span>
<span class="line">  &#125;</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line">// store.dispatch(action) 进去看看</span>
<span class="line">/*</span>
<span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span><span class="params">(action)</span></span> &#123;</span>
<span class="line">    //...</span>
<span class="line">	// 这里会读当前的观察者数组</span>
<span class="line">    var listeners = currentListeners = nextListeners;</span>
<span class="line">    <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; listeners.length; i++) &#123;</span>
<span class="line">      var listener = listeners[i];</span>
<span class="line">      listener();</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    <span class="keyword">return</span> action;</span>
<span class="line">  &#125;</span>
<span class="line">  </span>
<span class="line">  <span class="comment">---------------------</span></span>
<span class="line">  </span>
<span class="line">  在 console 打 listeners 会打印出 [<span class="function"><span class="keyword">function</span>]</span></span>
<span class="line"><span class="function">  <span class="title">listeners</span>[0] 是</span></span>
<span class="line"><span class="function">  <span class="title">function</span> <span class="params">()</span></span> &#123;</span>
<span class="line">  	console.<span class="built_in">log</span>(<span class="string">'我注册啦'</span>);</span>
<span class="line">  &#125;</span>
<span class="line">*/</span>
<span class="line"></span>
<span class="line">/*</span>
<span class="line">需要注意的一点是</span>
<span class="line">  // When a store is created, an <span class="string">"INIT"</span> action is dispatched so that every</span>
<span class="line">  // reducer returns their initial state. This effectively populates</span>
<span class="line">  // the initial state tree.</span>
<span class="line">  dispatch(&#123; <span class="built_in">type</span>: ActionTypes.INIT &#125;)</span>
<span class="line">  也就是说，每调用一遍 createStore 就会执行一遍 dispatch(&#123; <span class="built_in">type</span>: ActionTypes.INIT &#125;)</span>
<span class="line">  所以初始化的 action 是 <span class="built_in">type</span>: <span class="string">"@@redux/INIT"</span></span>
<span class="line">*/</span>
</pre></td></tr></table></figure>
<h3 id="怎么改变-dom"><a href="#怎么改变-dom" class="headerlink" title="怎么改变 dom"></a>怎么改变 dom</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// HTML</span></span>
<span class="line">    &lt;div id=<span class="string">'root'</span>&gt;</span>
<span class="line">        <span class="number">1</span></span>
<span class="line">    &lt;/div&gt;</span>
<span class="line"><span class="comment">// JS</span></span>
<span class="line"><span class="keyword">import</span> &#123; createStore &#125; from <span class="string">'redux'</span></span>
<span class="line"><span class="keyword">const</span> ROOTDOM = <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span>
<span class="line"><span class="keyword">const</span> initState = &#123;&#125;</span>
<span class="line"><span class="keyword">const</span> action = &#123;</span>
<span class="line">  	type: <span class="string">'init'</span>,</span>
<span class="line">  	payload: <span class="string">'hello world'</span>,</span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">const</span> reducer = (state, action) =&gt; &#123;  </span>
<span class="line">  	<span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, state, action); </span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">const</span> store = createStore(reducer, initState) </span>
<span class="line">store.subscribe(() =&gt; &#123;</span>
<span class="line">  	ROOTDOM.innerHTML = JSON.stringify(store.getState())</span>
<span class="line">&#125;)</span>
<span class="line">let counter = <span class="number">0</span></span>
<span class="line">ROOTDOM.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span>
<span class="line">  	counter++</span>
<span class="line">  	<span class="keyword">const</span> action = &#123;</span>
<span class="line">      	type: <span class="string">'click'</span>,</span>
<span class="line">      	payload: counter</span>
<span class="line">  	&#125;</span>
<span class="line">  	store.dispatch(action)</span>
<span class="line">&#125;)</span>
</pre></td></tr></table></figure>
<h3 id="实现一个MVVM"><a href="#实现一个MVVM" class="headerlink" title="实现一个MVVM"></a>实现一个MVVM</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// HTML</span></span>
<span class="line">&lt;input id=<span class="string">"name"</span>/&gt;</span>
<span class="line">数据预览区</span>
<span class="line">&lt;div id=<span class="string">"preview"</span>&gt;&lt;/div&gt;</span>
<span class="line">&lt;div id=<span class="string">'root'</span>&gt;</span>
<span class="line"><span class="number">1</span></span>
<span class="line">&lt;/div&gt;</span>
<span class="line"><span class="comment">// JS</span></span>
<span class="line"><span class="keyword">import</span> &#123; createStore &#125; from <span class="string">'redux'</span>;</span>
<span class="line"><span class="keyword">const</span> initState = &#123;&#125;;</span>
<span class="line"><span class="keyword">const</span> action = &#123;</span>
<span class="line">	type: <span class="string">'init'</span>,</span>
<span class="line">	payload: <span class="string">'hello world'</span>,</span>
<span class="line">&#125;;</span>
<span class="line"><span class="keyword">const</span> reducer = (state, action) =&gt; &#123;</span>
<span class="line">	<span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, state, action);</span>
<span class="line">&#125;;</span>
<span class="line"><span class="keyword">const</span> store = createStore(reducer, initState);</span>
<span class="line"><span class="keyword">const</span> INPUTDOM = <span class="built_in">document</span>.getElementById(<span class="string">'name'</span>);</span>
<span class="line"><span class="keyword">const</span> PREVIEWDOM = <span class="built_in">document</span>.getElementById(<span class="string">'preview'</span>);</span>
<span class="line"><span class="keyword">const</span> digestUI = () =&gt; &#123;</span>
<span class="line">	PREVIEWDOM.innerHTML = store.getState().payload;</span>
<span class="line">	<span class="keyword">if</span> (PREVIEWDOM.innerHTML.length &gt; <span class="number">20</span>) &#123;</span>
<span class="line">		alert(<span class="string">'length is 20'</span>)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;;</span>
<span class="line"><span class="keyword">const</span> inputChange = () =&gt;&#123;</span>
<span class="line">	let val = INPUTDOM.value;</span>
<span class="line">	<span class="keyword">const</span> action = &#123;</span>
<span class="line">		type: <span class="string">'input_change'</span>,</span>
<span class="line">		payload: val,</span>
<span class="line">	&#125;;</span>
<span class="line">	store.dispatch(action);</span>
<span class="line">&#125;;</span>
<span class="line">let counter = <span class="number">0</span>;</span>
<span class="line">INPUTDOM.addEventListener(<span class="string">'input'</span>, inputChange)</span>
<span class="line">store.subscribe(digestUI);</span>
<span class="line"></span>
<span class="line"><span class="comment">// 可以看出好处就是行为都是分离的</span></span>
</pre></td></tr></table></figure>
<h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// redux中的applyMiddleware中间件</span></span>
<span class="line"><span class="comment">// Middleware makes it easier for software developers</span></span>
<span class="line"><span class="comment">// to implement 【communication and input/output】,</span></span>
<span class="line"><span class="comment">// so they can focus on the 【specific purpose of their application】.</span></span>
<span class="line"><span class="comment">// 更专注 service 服务 input/output service 输入和输出</span></span>
<span class="line"><span class="comment">// ajax ==&gt; json(乱得一笔) =service转换(中间件)=&gt; UI(整理成好的)</span></span>
<span class="line"><span class="comment">// express/Koa</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 前端</span></span>
<span class="line"><span class="comment">// ajax ==http==&gt;</span></span>
<span class="line"><span class="comment">// httpRequest(head,cookie,body)</span></span>
<span class="line"><span class="comment">// middlewares(解析cookie, 拿到post请求的数据)</span></span>
<span class="line"><span class="comment">// 数据就是好的一笔的数据</span></span>
<span class="line"><span class="comment">// 后端(node.js)</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 看一个例子</span></span>
<span class="line"><span class="comment">// 注意下面这些很多箭头的叫做高阶函数</span></span>
<span class="line"><span class="comment">// 例如 const highFunction = a =&gt; b =&gt; c =&gt; console.log(a+b+c); highFunction(1)(2)(3) // 6 // 一个函数执行完之后返回值是一个函数</span></span>
<span class="line"><span class="comment">// 多参函数 ===&gt; 单参函数</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 如果在 createStore 用上 enhancer 逻辑就会被 applyMiddleware 控制</span></span>
<span class="line"><span class="comment">// return enhancer(createStore)(reducer, preloadedState)</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 前一个 next 指向下一个 action=&gt; &#123; next(action) &#125;; 最后一个 next 指向 dispatch </span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 没有中间件 action ==&gt; ==dispatch==&gt; reducer ==&gt; nextState;</span></span>
<span class="line"><span class="comment">// 有中间件 action ==middlewares==&gt; ==dispatch==&gt; reducer ==&gt; nextState;</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// applyMiddleware 的思想是把一堆函数封装成一个函数</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span>
<span class="line"><span class="keyword">const</span> logger1 = <span class="function"><span class="params">store</span> =&gt;</span> next =&gt; <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span>
<span class="line">    <span class="built_in">console</span>.log(<span class="string">'current dipatch'</span> + <span class="built_in">JSON</span>.stringify(action));</span>
<span class="line">    next(action);</span>
<span class="line">&#125;;</span>
<span class="line"><span class="keyword">const</span> logger2 = <span class="function"><span class="params">store</span> =&gt;</span> next =&gt; <span class="function"><span class="params">action</span>=&gt;</span> &#123;</span>
<span class="line">    next(action);</span>
<span class="line">&#125;;</span>
<span class="line"><span class="keyword">const</span> logger3 = <span class="function"><span class="params">store</span> =&gt;</span> next =&gt; <span class="function"><span class="params">action</span>=&gt;</span> &#123;</span>
<span class="line">    next(action);</span>
<span class="line">&#125;;</span>
<span class="line"></span>
<span class="line"><span class="keyword">const</span> enhancer = applyMiddleware(logger1, logger2, logger3);</span>
<span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> state;</span>
<span class="line"><span class="keyword">const</span> store = createStore(reducer, &#123;&#125;, enhancer);</span>
<span class="line">store.dispatch(&#123;<span class="keyword">type</span>:<span class="number">1</span>&#125;);</span>
<span class="line">store.dispatch(&#123;<span class="keyword">type</span>:<span class="number">2</span>&#125;);</span>
<span class="line">store.dispatch(&#123;<span class="keyword">type</span>:<span class="number">3</span>&#125;);</span>
</pre></td></tr></table></figure>
<p>action 的另一种写法 <a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="external">https://github.com/acdlite/flux-standard-action</a></p>
<p><a href="https://stackoverflow.com/questions/32646920/whats-the-at-symbol-in-the-redux-connect-decorator" target="_blank" rel="external">What’s the ‘@’ (at symbol) in the Redux @connect decorator?</a></p>
<p><a href="http://taobaofed.org/blog/2016/08/18/react-redux-connect/" target="_blank" rel="external">React 实践心得：react-redux 之 connect 方法详解</a></p>
<h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><p><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">ES6 教程</a></p>
<p><a href="https://frankietang.github.io/2017/10/14/%E6%91%B8%E5%88%B0%20ES6%20%E7%9A%84%E9%97%A8%E6%8A%8A%E6%89%8B/" target="_blank" rel="external">摸到 ES6 的门把手</a></p>
<p>Stage 0 - Strawman（展示阶段）</p>
<ul>
<li>Stage 1 - Proposal（征求意见阶段）</li>
<li>Stage 2 - Draft（草案阶段）</li>
<li>Stage 3 - Candidate（候选人阶段）</li>
<li>Stage 4 - Finished（定案阶段）</li>
</ul>
<p>配 babel 的时候有用 </p>
<h3 id="Set-和-Map-的数据结构"><a href="#Set-和-Map-的数据结构" class="headerlink" title="Set 和 Map 的数据结构"></a>Set 和 Map 的数据结构</h3><p><a href="https://github.com/ruanyf/es6tutorial/blob/2ac6e76b38f117f2acf6c465ab70709275b4241a/docs/set-map.md" target="_blank" rel="external">set-map</a></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 向 Set 加入值的时候，不会发生类型转换，所以5和"5"是两个不同的值。Set 内部判断两个值是否不同，使用的算法叫做“Same-value equality”，它类似于精确相等运算符（===），主要的区别是NaN等于自身，而精确相等运算符认为NaN不等于自身。</span></span>
<span class="line">let s = new Set()</span>
<span class="line">s.size <span class="comment">// 0</span></span>
<span class="line">s.add(<span class="number">1</span>) <span class="comment">// &#123;1&#125;</span></span>
<span class="line">s.size <span class="comment">// 1</span></span>
<span class="line">s.add(<span class="number">1</span>) <span class="comment">// &#123;1&#125;</span></span>
<span class="line">s.size <span class="comment">// 1</span></span>
<span class="line">s.add('<span class="number">1</span>') <span class="comment">// &#123;1,'1'&#125;</span></span>
<span class="line">s.size <span class="comment">// 2</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 如何快速去除数组里的重复元素</span></span>
<span class="line">[...new Set([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>])]  <span class="comment">// (5) [1, 2, 3, 4, 5]</span></span>
</pre></td></tr></table></figure>
<h3 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 对类做一个封装</span></span>
<span class="line"><span class="comment">// 懂了，大概就是在 class 上面绑定方法可以直接调用</span></span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">target</span>)</span>&#123;</span>
<span class="line">  target.prototype.divide = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;<span class="keyword">return</span> a/b&#125;</span>
<span class="line">  <span class="keyword">return</span> target</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">@divide</span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span></span>&#123;</span>
<span class="line">  add(a,b)&#123;</span>
<span class="line">    <span class="keyword">return</span> a+b</span>
<span class="line">  &#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="built_in">Math</span>()</span>
<span class="line"><span class="built_in">console</span>.log(m.divide(<span class="number">6</span>,<span class="number">3</span>)) <span class="comment">// 2</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 再封装多一个判断</span></span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">needAdd</span>)</span>&#123;</span>
<span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>)</span>&#123;</span>
<span class="line">    <span class="keyword">if</span>(needAdd)&#123;</span>
<span class="line">      target.prototype.divide = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;<span class="keyword">return</span> a/b&#125;</span>
<span class="line">    &#125;</span>
<span class="line">  &#125;</span>
<span class="line">  <span class="keyword">return</span> target</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">@divide(<span class="literal">true</span>)</span>
<span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span></span>&#123;</span>
<span class="line">  add(a,b)&#123;</span>
<span class="line">    <span class="keyword">return</span> a+b</span>
<span class="line">  &#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="built_in">Math</span>()</span>
<span class="line"><span class="built_in">console</span>.log(m.divide(<span class="number">6</span>,<span class="number">3</span>)) <span class="comment">// 2</span></span>
</pre></td></tr></table></figure>
<h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><p><a href="https://webpack.js.org/" target="_blank" rel="external">webpack 官方文档</a></p>
<h3 id="webpack-与-react"><a href="#webpack-与-react" class="headerlink" title="webpack 与 react"></a>webpack 与 react</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要是配 loaders</span></span>
<span class="line">&#123;</span>
<span class="line"><span class="symbol">    test:</span> /\.js[x]?$/,        <span class="comment">// 符合 js 或者 jsx</span></span>
<span class="line"><span class="symbol">    loader:</span> <span class="string">"babel-loader"</span>,   <span class="comment">// 运行 babel-loader</span></span>
<span class="line"><span class="symbol">    exclude:</span> /node_modules/</span>
<span class="line">&#125;,</span>
</pre></td></tr></table></figure>
<p>说实话 webpack 这东西翻翻文档就好，不用死记硬背的。要什么功能直接 Google ，<code>npm i -D &lt;package&gt;</code></p>
<p><a href="https://juejin.im/post/59bb37fa6fb9a00a554f89d2" target="_blank" rel="external">webpack：从入门到真实项目配置</a></p>
<h2 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h2><p><a href="http://babeljs.io/" target="_blank" rel="external">babel 官方文档</a></p>
<h3 id="babel-1"><a href="#babel-1" class="headerlink" title="babel"></a>babel</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为 react 用的是 JSX 所以需要用到 babel</span></span>
<span class="line"><span class="comment">// 不止 JSX 还有高阶组件(HOC) 要用到 es7 的 Decorator</span></span>
<span class="line"><span class="comment">// 把这一堆代码转换成 JS</span></span>
<span class="line"><span class="comment">// 以下是配法 </span></span>
<span class="line">&#123;</span>
<span class="line">  <span class="string">"presets"</span>: [</span>
<span class="line">     <span class="string">"stage-0"</span>, <span class="comment">// 草案 0</span></span>
<span class="line">     <span class="string">"es2015"</span>,  <span class="comment">// es6</span></span>
<span class="line">     <span class="string">"react"</span>    <span class="comment">// react</span></span>
<span class="line">  ],</span>
<span class="line">   <span class="string">"plugins"</span>: [<span class="string">"transform-decorators-legacy"</span>]  <span class="comment">// 翻译 Decorator</span></span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/10/25/deepin shadowsocks-qt5 全局翻了个墙/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2017/11/05/补基础：React-Redux-ES6-webpack-babel/';
var disqus_title = '补基础：React-Redux-ES6-webpack-babel';
var disqus_url = 'http://yoursite.com/2017/11/05/补基础：React-Redux-ES6-webpack-babel/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 <a href="http://yoursite.com">Frankie Tang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>