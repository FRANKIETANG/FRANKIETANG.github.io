<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 摸到 webpack 的门把手 · 付林恒的博客</title><meta name="description" content="摸到 webpack 的门把手 - Frankie Tang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="付林恒的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/frankietang" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">摸到 webpack 的门把手</h1><div class="post-info">Oct 14, 2017</div><div class="post-content"><h1 id="摸到-webpack-的门把手"><a href="#摸到-webpack-的门把手" class="headerlink" title="摸到 webpack 的门把手"></a>摸到 webpack 的门把手</h1><p>之前接触过一阵子 webpack ，想了一下还是写篇博客吧。要不然又忘掉怎么配置了。</p>
<h2 id="怎么安装？"><a href="#怎么安装？" class="headerlink" title="怎么安装？"></a>怎么安装？</h2><p><a href="https://webpack.js.org/" target="_blank" rel="external">来，我们先看 webpack 的官网</a></p>
<p>点击到 guides ，我们直接抄，抄完我们就知道 webpack 的流程了</p>
<p>不过有几点我们是要注意的</p>
<ul>
<li>注意 index.js 中的 <code>_.join</code>，这个 _ 实际上是 lodash 暴露的全局变量。</li>
<li>为了使用 lodash，HTML 使用 script 引入了 lodash v4.16.6。可以用 npm 装回来 <code>npm install --save lodash</code></li>
<li>尽量运行 <code>./node_modules/.bin/webpack</code> </li>
</ul>
<h2 id="看看文件结构"><a href="#看看文件结构" class="headerlink" title="看看文件结构"></a>看看文件结构</h2><ul>
<li><code>./node_modules/.bin/webpack src/index.js dist/bundle.js</code> 将 src/index.js 变成 dist/bundle.js</li>
<li>index.html 引用的是 dist/bundle.js</li>
<li>lodash 被安装在 node_modules 里</li>
<li>webpack 也被安装在 node_modules里，<code>./node_modules/.bin/webpack</code> 就是一个可执行文件</li>
<li>webpack、lodash 的版本号都被写在 package.json 里了</li>
</ul>
<p><a href="http://www.ruanyifeng.com/blog/2012/08/how_to_read_diff.html" target="_blank" rel="external">读懂diff - 阮一峰</a></p>
<h2 id="引用-jQuery"><a href="#引用-jQuery" class="headerlink" title="引用 jQuery"></a>引用 jQuery</h2><ul>
<li><p><code>npm i -S jquery</code></p>
<pre><code> import _ from &#39;lodash&#39;
+import j from &#39;jquery&#39;

 function component () {
-  var element = document.createElement(&#39;div&#39;);
+  var element = j(&#39;&lt;div&gt;&lt;/div&gt;&#39;);

   /* lodash is required for the next line to work */
-  element.innerHTML = _.join([&#39;Hello&#39;,&#39;webpack&#39;], &#39; &#39;);
+  element.html(_.join([&#39;Hello&#39;,&#39;webpack&#39;], &#39; &#39;))

-  return element;
+  return element.get(0);
 }

 document.body.appendChild(component());
</code></pre></li>
<li><p><code>./node_modules/.bin/webpack src/index.js dist/bundle.js</code> 跑这句话</p>
</li>
<li><p>点击 commits 看看有什么变化</p>
</li>
<li><p>建议 index.js 改成 <code>console.log(1)</code> 然后运行 <code>./node_modules/.bin/webpack src/index.js dist/bundle.js</code>，看看 bundle.js 和 index.js 的区别</p>
</li>
</ul>
<h2 id="做一点改良"><a href="#做一点改良" class="headerlink" title="做一点改良"></a>做一点改良</h2><ul>
<li><p>我们可以在根目录搞一个 <code>webpack.config.js</code>，在里面写上一点代码。</p>
<pre><code>var path = require(&#39;path&#39;)

module.exports = {
    entry: &#39;./src/index.js&#39;,
    output: {
        filename: &#39;bundle.js&#39;,
        path: path.resolve(__dirname, &#39;dist&#39;)
    }
}
</code></pre><p>重点是这三个玩意 src/index.js 、dist 和 bundle.js 在哪就行，方便我们后面改。</p>
</li>
<li><p>然后我们就可以用上这句 <code>./node_modules/.bin/webpack --config webpack.config.js</code></p>
</li>
<li><p>或者我们可以进行下面的改良</p>
<pre><code>  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
    &quot;webpack&quot;: &quot;webpack&quot;
  },
  &quot;keywords&quot;: [],
</code></pre><p>然后运行 npm run webpack</p>
</li>
</ul>
<h2 id="尝试-import-一个自己的文件"><a href="#尝试-import-一个自己的文件" class="headerlink" title="尝试 import 一个自己的文件"></a>尝试 import 一个自己的文件</h2><ul>
<li><p>创建一个 <code>foo.js</code></p>
<pre><code>export default function(){
    return &#39;tangkalun&#39;
}
</code></pre></li>
<li><p>然后在 <code>index.js</code> 加上 <code>import foo from &#39;./foo&#39;</code>，顺便 <code>console.log</code> 一下</p>
</li>
<li><p><code>npm run webpack</code></p>
</li>
</ul>
<h2 id="利用-webpack-压缩-JS-文件"><a href="#利用-webpack-压缩-JS-文件" class="headerlink" title="利用 webpack 压缩 JS 文件"></a>利用 webpack 压缩 JS 文件</h2><ul>
<li><p><a href="https://webpack.js.org/guides/production/" target="_blank" rel="external">webpack 自带的</a> 支持所有 <a href="https://github.com/mishoo/UglifyJS2#usage" target="_blank" rel="external">UglifyJS 选项</a></p>
</li>
<li><p>在 <code>webpack.config.js</code> 加上这样一句话，UglifyJS 的选项可以一个都不加</p>
<pre><code>var webpack = require(&#39;webpack&#39;);

module.exports = {
  /*...*/
  plugins:[
    new webpack.optimize.UglifyJsPlugin()
  ]
};
</code></pre></li>
<li><p><code>npm run webpack</code></p>
</li>
<li><p>压完了</p>
</li>
</ul>
<h2 id="看看成果"><a href="#看看成果" class="headerlink" title="看看成果"></a>看看成果</h2><p><a href="https://github.com/FRANKIETANG/webpack-demo" target="_blank" rel="external">点击这里</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/10/14/摸到 webpack 的门把手 (2)/" class="prev">PREV</a><a href="/2017/10/14/摸到 Promise 的门把手/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2017/10/14/摸到 webpack 的门把手/';
var disqus_title = '摸到 webpack 的门把手';
var disqus_url = 'http://yoursite.com/2017/10/14/摸到 webpack 的门把手/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 <a href="http://yoursite.com">Frankie Tang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>