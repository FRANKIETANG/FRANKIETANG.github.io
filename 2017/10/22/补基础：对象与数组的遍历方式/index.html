<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 补基础：对象与数组的遍历方式 · 付林恒的博客</title><meta name="description" content="补基础：对象与数组的遍历方式 - Frankie Tang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="付林恒的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/frankietang" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">补基础：对象与数组的遍历方式</h1><div class="post-info">Oct 22, 2017</div><div class="post-content"><h1 id="补基础：对象与数组的遍历方式"><a href="#补基础：对象与数组的遍历方式" class="headerlink" title="补基础：对象与数组的遍历方式"></a>补基础：对象与数组的遍历方式</h1><blockquote>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames" target="_blank" rel="external">Object.getOwnPropertyNames</a></li>
</ul>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="external">Object.defineProperty</a></li>
</ul>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor" target="_blank" rel="external">Object.getOwnPropertyDescriptor</a></li>
</ul>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptors" target="_blank" rel="external">getOwnPropertyDescriptors</a></li>
</ul>
</blockquote>
<h2 id="数组的遍历"><a href="#数组的遍历" class="headerlink" title="数组的遍历"></a>数组的遍历</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++)&#123;</span>
<span class="line">  	<span class="built_in">console</span>.log(arr[i])</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">arr.forEach(<span class="function">(<span class="params">it, index, self</span>) =&gt;</span> &#123;</span>
<span class="line">  	<span class="built_in">console</span>.log(it, index, self)</span>
<span class="line">&#125;)</span>
<span class="line"><span class="comment">// 1 0 [1,2,3]</span></span>
<span class="line"><span class="comment">// 2 1 [1,2,3]</span></span>
<span class="line"><span class="comment">// 3 2 [1,2,3]</span></span>
<span class="line"><span class="comment">// 等于</span></span>
<span class="line">arr.forEach(<span class="built_in">console</span>.log)</span>
</pre></td></tr></table></figure>
<h2 id="对象的遍历"><a href="#对象的遍历" class="headerlink" title="对象的遍历"></a>对象的遍历</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="string">'b'</span>, <span class="attr">c</span>: <span class="string">'d'</span>&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 打印出</span></span>
<span class="line"><span class="comment">// key a -&gt; b</span></span>
<span class="line"><span class="comment">// key c -&gt; d</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span>
<span class="line">  	<span class="built_in">console</span>.log(<span class="string">`key <span class="subst">$&#123;key&#125;</span> -&gt; <span class="subst">$&#123;obj[key]&#125;</span>`</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 要注意的是，for in 会遍历原型链上的属性</span></span>
<span class="line"><span class="comment">// 但是并没有打印到 console.log(obj.toString) 这个值</span></span>
<span class="line"><span class="comment">// 没有打印 key toString -&gt; [Function: toString]</span></span>
<span class="line"></span>
<span class="line"><span class="built_in">Object</span>.prototype.test = <span class="string">'mytest'</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// key a -&gt; b</span></span>
<span class="line"><span class="comment">// key c -&gt; d</span></span>
<span class="line"><span class="comment">// key test -&gt; mytest</span></span>
<span class="line"><span class="comment">// 说明确实会遍历找到原型链上的属性</span></span>
<span class="line"><span class="comment">// 那为什么 toString 没有打印出来？</span></span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="built_in">Object</span>.prototype, <span class="string">'toString'</span>))</span>
<span class="line"><span class="comment">// &#123;writable: true, enumerable: false, configurable: true, value: ƒ&#125;</span></span>
<span class="line"><span class="comment">// 通过 getOwnPropertyDescriptor 看到 enumerable 的确是 false ，说明了不可枚举。 </span></span>
<span class="line"><span class="comment">// 所以说 Object.prototype 里面内置的方法大多数都是不可枚举的</span></span>
</pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 那怎么可以只 for in 自身属性呢而不会遍历其他赋予到原型链上的属性呢？ （有的第三方库会在原型链上赋值）</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="string">'b'</span>, <span class="attr">c</span>: <span class="string">'d'</span>&#125;</span>
<span class="line"></span>
<span class="line"><span class="built_in">Object</span>.prototype.test = <span class="string">'mytest'</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span>
<span class="line">	<span class="comment">// 只遍历自身属性 可以加一层判断</span></span>
<span class="line">	<span class="keyword">if</span>(obj.hasOwnProperty(key)) &#123;</span>
<span class="line">      	<span class="built_in">console</span>.log(<span class="string">`key <span class="subst">$&#123;key&#125;</span> -&gt; <span class="subst">$&#123;obj[key]&#125;</span>`</span>)</span>
<span class="line">	&#125;</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 看一个使用场景</span></span>
<span class="line"><span class="selector-tag">function</span> <span class="selector-tag">validUser</span>(obj) &#123;</span>
<span class="line">    <span class="comment">// 同时具有name, age属性的为合法用户</span></span>
<span class="line">	<span class="selector-tag">return</span> <span class="selector-tag">obj</span><span class="selector-class">.hasOwnProperty</span>(<span class="string">'name'</span>) <span class="selector-tag">&amp;</span><span class="selector-tag">&amp;</span> <span class="selector-tag">obj</span><span class="selector-class">.hasOwnProperty</span>(<span class="string">'age'</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="selector-tag">console</span><span class="selector-class">.log</span>(validUser(&#123;<span class="attribute">name</span>: <span class="string">'mike'</span>&#125;)); <span class="comment">// false;</span></span>
<span class="line"><span class="selector-tag">console</span><span class="selector-class">.log</span>(validUser(&#123;<span class="attribute">age</span>: <span class="number">15</span>&#125;)); <span class="comment">// false</span></span>
<span class="line"><span class="selector-tag">console</span><span class="selector-class">.log</span>(validUser(&#123;<span class="attribute">name</span>: <span class="string">'xiaohong'</span>, <span class="attribute">age</span>: <span class="number">18</span>&#125;)); <span class="comment">// true</span></span>
</pre></td></tr></table></figure>
<p>要注意不能用 <code>(!!obj.name &amp;&amp; !!obj.age)</code> 这种方法，要考虑到 <code>{age: 0}</code> 的可能性或者其他 如：<code>!!0 -&gt; false</code> <code>!!{} -&gt; true</code> <code>!![] -&gt; true</code> <code>!!&#39;&#39; -&gt; false</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 多个属性</span></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validUser</span>(<span class="params">obj</span>) </span>&#123;</span>
<span class="line">    <span class="comment">// 同时具有 name, age, sex 属性的为合法用户</span></span>
<span class="line">    <span class="comment">// 若是上面那种做法，会导致多属性很麻烦</span></span>
<span class="line">	<span class="comment">// return obj.hasOwnProperty('name') &amp;&amp; </span></span>
<span class="line">	<span class="comment">//	      obj.hasOwnProperty('age') &amp;&amp;</span></span>
<span class="line">	<span class="comment">//	      obj.hasOwnProperty('sex')</span></span>
<span class="line">	<span class="comment">// 以下为解决方法</span></span>
<span class="line">	<span class="keyword">return</span> requiredFields.every(<span class="function">(<span class="params">it</span>) =&gt;</span> &#123;</span>
<span class="line">      	<span class="keyword">return</span> obj.hasOwnProperty(it)</span>
<span class="line">	&#125;)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 可以先配置成一个数组, 改变量就好</span></span>
<span class="line"><span class="keyword">let</span> requiredFields = [<span class="string">'name'</span>, <span class="string">'age'</span>, <span class="string">'sex'</span>]</span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(validUser(&#123;<span class="attr">name</span>: <span class="string">'mike'</span>&#125;)); <span class="comment">// false;</span></span>
<span class="line"><span class="built_in">console</span>.log(validUser(&#123;<span class="attr">age</span>: <span class="number">15</span>&#125;)); <span class="comment">// false</span></span>
<span class="line"><span class="built_in">console</span>.log(validUser(&#123;<span class="attr">name</span>: <span class="string">'xiaohong'</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;)); <span class="comment">// true</span></span>
<span class="line"><span class="built_in">console</span>.log(validUser(&#123;<span class="attr">name</span>: <span class="string">'xiaohong'</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">sex</span>: <span class="string">'ddd'</span>&#125;)); <span class="comment">// true</span></span>
</pre></td></tr></table></figure>
<h2 id="Object-keys-obj"><a href="#Object-keys-obj" class="headerlink" title="Object.keys(obj)"></a>Object.keys(obj)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 另外一种遍历方法 Object.keys(obj)</span></span>
<span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="string">'b'</span>, <span class="attr">c</span>: <span class="string">'d'</span>&#125;</span>
<span class="line"></span>
<span class="line"><span class="built_in">Object</span>.prototype.test = <span class="string">'myTest'</span></span>
<span class="line"></span>
<span class="line"><span class="built_in">Object</span>.keys(obj).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span>
<span class="line">  	<span class="built_in">console</span>.log(<span class="string">`key <span class="subst">$&#123;key&#125;</span> -&gt; <span class="subst">$&#123;obj[key]&#125;</span>`</span>)</span>
<span class="line">&#125;)</span>
<span class="line"></span>
<span class="line"><span class="comment">// 这个方法只能遍历到自身可枚举属性，那有没有办法可以遍历到不可枚举属性呢？</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 打印所有自身属性，包含不可枚举</span></span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj)) <span class="comment">// ["a", "c", "nonEnumerable"]</span></span>
<span class="line"></span>
<span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(obj).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span>
<span class="line">  	<span class="built_in">console</span>.log(<span class="string">`key <span class="subst">$&#123;key&#125;</span> -&gt; <span class="subst">$&#123;obj[key]&#125;</span>`</span>)</span>
<span class="line">&#125;)</span>
<span class="line"></span>
<span class="line"><span class="comment">// key a -&gt; b</span></span>
<span class="line"><span class="comment">// key c -&gt; d</span></span>
<span class="line"><span class="comment">// key nonEnumerable -&gt; static</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 设置不可枚举的方法</span></span>
<span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'nonEnumerable'</span>, &#123;</span>
<span class="line">    enumerable: <span class="literal">false</span>,</span>
<span class="line">    configurable: <span class="literal">false</span>,</span>
<span class="line">    writable: <span class="literal">false</span>,</span>
<span class="line">    value: <span class="string">'static'</span></span>
<span class="line">&#125;);</span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(obj.nonEnumerable) <span class="comment">// 'static'</span></span>
<span class="line"><span class="built_in">console</span>.log(obj.hasOwnProperty(<span class="string">'nonEnumerable'</span>)) <span class="comment">// ture</span></span>
<span class="line"><span class="comment">// 说明 obj 自身有 nonEnumerable ，设置为 static</span></span>
</pre></td></tr></table></figure>
<h2 id="get-set"><a href="#get-set" class="headerlink" title="get - set"></a>get - set</h2><p>数据双向绑定</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;a: <span class="string">'b'</span>&#125;</span>
<span class="line"></span>
<span class="line"><span class="comment">// 可以这样</span></span>
<span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'c'</span>, &#123;</span>
<span class="line">    <span class="keyword">get</span>() &#123;</span>
<span class="line">    	<span class="comment">// business logic 业务逻辑</span></span>
<span class="line">    	<span class="comment">// if(...) &#123;</span></span>
<span class="line">        <span class="comment">//  	throw Error()</span></span>
<span class="line">    	<span class="comment">// &#125; </span></span>
<span class="line">    	<span class="comment">// return 3 </span></span>
<span class="line">      	<span class="keyword">return</span> <span class="number">2</span></span>
<span class="line">    &#125;,</span>
<span class="line">    <span class="keyword">set</span>() &#123;</span>
<span class="line">   		<span class="comment">// 绑定逻辑 vue 的原理</span></span>
<span class="line">      	<span class="built_in">console</span>.log(<span class="string">'setting value'</span>)</span>
<span class="line">    &#125;</span>
<span class="line">&#125;);</span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(obj.c) <span class="comment">// 在什么情况下会打印出 2 ？</span></span>
<span class="line">obj.c = <span class="number">10</span>         <span class="comment">// 相当于运行了 set() 这个函数 打印出 setting value</span></span>
<span class="line"><span class="built_in">console</span>.log(obj.c) <span class="comment">// 仍然是 2</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 也就是说可以变成一个私有变量</span></span>
</pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果要设置深层次的赋值</span></span>
<span class="line">obj = &#123;</span>
<span class="line">    a: &#123;</span>
<span class="line">        b: &#123;</span>
<span class="line">            c: &#123;</span>
<span class="line">                d: <span class="number">3</span></span>
<span class="line">            &#125;</span>
<span class="line">        &#125;</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
<span class="line"><span class="built_in">console</span>.log(obj.a.b.c.d); <span class="comment">// 3</span></span>
<span class="line"></span>
<span class="line"><span class="comment">// 用 defineProperty</span></span>
<span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'_deep'</span>, &#123;</span>
<span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span>
<span class="line">        <span class="keyword">return</span> obj.a.b.c.d;</span>
<span class="line">    &#125;</span>
<span class="line">&#125;);</span>
<span class="line"></span>
<span class="line"><span class="built_in">console</span>.log(obj._deep); <span class="comment">//3</span></span>
</pre></td></tr></table></figure>
<h2 id="怎么大小通吃"><a href="#怎么大小通吃" class="headerlink" title="怎么大小通吃"></a>怎么大小通吃</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象和数组一起遍历</span></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_each</span>(<span class="params">objOrArray, callback</span>) </span>&#123;</span>
<span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(objOrArray).toLowerCase() === <span class="string">'[object array]'</span>)&#123;</span>
<span class="line">        objOrArray.forEach(callback); </span>
<span class="line">    &#125;</span>
<span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(objOrArray).toLowerCase() === <span class="string">'[object object]'</span>)&#123;</span>
<span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> objOrArray)&#123;</span>
<span class="line">            <span class="keyword">if</span>(objOrArray.hasOwnProperty(key))&#123;</span>
<span class="line">                callback(key,objOrArray[key]);</span>
<span class="line">            &#125;</span>
<span class="line">        &#125;</span>
<span class="line">    &#125;  	</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">_each([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">it, index</span>) </span>&#123;</span>
<span class="line">    <span class="built_in">console</span>.log(it + index);  </span>
<span class="line">&#125;); </span>
<span class="line"><span class="comment">// 1</span></span>
<span class="line"><span class="comment">// 3</span></span>
<span class="line"><span class="comment">// 5</span></span>
<span class="line"></span>
<span class="line">_each(&#123;<span class="attr">a</span>: <span class="string">'b'</span>, <span class="attr">c</span>: <span class="string">'d'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>) </span>&#123;</span>
<span class="line">    <span class="built_in">console</span>.log(key + value);</span>
<span class="line">&#125;);</span>
<span class="line"><span class="comment">// ab</span></span>
<span class="line"><span class="comment">// cd</span></span>
</pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
</pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置一个上下文</span></span>
<span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_each</span>(<span class="params">objOrArray, callback, ctx</span>)</span>&#123;</span>
<span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(objOrArray).toLowerCase() === <span class="string">'[object array]'</span>)&#123;</span>
<span class="line">        objOrArray.forEach(callback, ctx || <span class="keyword">this</span>); </span>
<span class="line">    &#125;</span>
<span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(objOrArray).toLowerCase() === <span class="string">'[object object]'</span>)&#123;</span>
<span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> objOrArray)&#123;</span>
<span class="line">            <span class="keyword">if</span>(objOrArray.hasOwnProperty(key))&#123;</span>
<span class="line">                callback.call(ctx || <span class="keyword">this</span>, key,objOrArray[key]);</span>
<span class="line">            &#125;</span>
<span class="line">        &#125;</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">_each([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">it, index</span>) </span>&#123;</span>
<span class="line">    <span class="built_in">console</span>.log(it + index + <span class="keyword">this</span>.a);  </span>
<span class="line">&#125;, &#123;<span class="attr">a</span>: <span class="number">3</span>&#125;); </span>
<span class="line"><span class="comment">// 4</span></span>
<span class="line"><span class="comment">// 6</span></span>
<span class="line"><span class="comment">// 8</span></span>
<span class="line"></span>
<span class="line">_each(&#123;<span class="attr">a</span>: <span class="string">'b'</span>, <span class="attr">c</span>: <span class="string">'d'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>) </span>&#123;</span>
<span class="line">    <span class="built_in">console</span>.log(key + value + <span class="keyword">this</span>.a);</span>
<span class="line">&#125;, &#123;<span class="attr">a</span>: <span class="string">'e'</span>&#125;);</span>
<span class="line"><span class="comment">// abe</span></span>
<span class="line"><span class="comment">// cde</span></span>
</pre></td></tr></table></figure>
<p>三板斧 <code>typeof</code> <code>Array.isArray([1,2])</code> <code>(Object.prototype.toString.call([1,2])</code></p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/10/24/补基础：函数/" class="prev">PREV</a><a href="/2017/10/19/补基础：this/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2017/10/22/补基础：对象与数组的遍历方式/';
var disqus_title = '补基础：对象与数组的遍历方式';
var disqus_url = 'http://yoursite.com/2017/10/22/补基础：对象与数组的遍历方式/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 <a href="http://yoursite.com">Frankie Tang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>